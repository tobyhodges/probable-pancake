<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Introduction to High-Performance Computing: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="manifest" href="site.webmanifest">
<link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav carpentries"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="cp-logo" alt="Lesson Description" src="assets/images/carpentries-logo.svg"><span class="badge text-bg-warning">
          <abbr title="This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#field-testing-alpha-stage" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-triangle" style="border-radius: 5px"></i>
              Alpha
            </a>
            <span class="visually-hidden">This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav carpentries" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Lesson Description" src="assets/images/carpentries-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Introduction to High-Performance Computing
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Introduction to High-Performance Computing
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="discuss.html">Taking Your Next Steps</a></li>
<li><a class="dropdown-item" href="reference.html">Knowledge Base</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Introduction to High-Performance Computing
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress carpentries">
    <div class="progress-bar carpentries" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="10-hpc-intro.html">1. Why use a Cluster?</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="11-connecting.html">2. Connecting to a remote HPC system</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="12-cluster.html">3. Exploring Remote Resources</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="13-scheduler.html">4. Scheduler Fundamentals</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="14-environment-variables.html">5. Environment Variables</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="15-modules.html">6. Accessing software via Modules</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="16-transferring-files.html">7. Transferring files with remote computers</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="17-parallel.html">8. Running a parallel job</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="18-resources.html">9. Using resources effectively</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="19-responsibility.html">10. Using shared resources responsibly</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="discuss.html">Taking Your Next Steps</a></li>
<li><a href="reference.html">Knowledge Base</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-10-hpc-intro"><p>Content from <a href="10-hpc-intro.html">Why use a Cluster?</a></p>
<hr>
<p>Last updated on 2024-09-26 |

        <a href="https://github.com/tobyhodges/probable-pancake/edit/main/episodes/10-hpc-intro.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Why would I be interested in High Performance Computing (HPC)?</li>
<li>What can I expect to learn from this course?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe what an HPC system is</li>
<li>Identify how an HPC system could benefit you.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Frequently, research problems that use computing can outgrow the
capabilities of the desktop or laptop computer where they started:</p>
<ul>
<li>A statistics student wants to cross-validate a model. This involves
running the model 1000 times – but each run takes an hour. Running the
model on a laptop will take over a month! In this research problem,
final results are calculated after all 1000 models have run, but
typically only one model is run at a time (in <strong>serial</strong>)
on the laptop. Since each of the 1000 runs is independent of all others,
and given enough computers, it’s theoretically possible to run them all
at once (in <strong>parallel</strong>).</li>
<li>A genomics researcher has been using small datasets of sequence
data, but soon will be receiving a new type of sequencing data that is
10 times as large. It’s already challenging to open the datasets on a
computer – analyzing these larger datasets will probably crash it. In
this research problem, the calculations required might be impossible to
parallelize, but a computer with <strong>more memory</strong> would be
required to analyze the much larger future data set.</li>
<li>An engineer is using a fluid dynamics package that has an option to
run in parallel. So far, this option was not used on a desktop. In going
from 2D to 3D simulations, the simulation time has more than tripled. It
might be useful to take advantage of that option or feature. In this
research problem, the calculations in each region of the simulation are
largely independent of calculations in other regions of the simulation.
It’s possible to run each region’s calculations simultaneously (in
<strong>parallel</strong>), communicate selected results to adjacent
regions as needed, and repeat the calculations to converge on a final
set of results. In moving from a 2D to a 3D model, <strong>both the
amount of data and the amount of calculations increases
greatly</strong>, and it’s theoretically possible to distribute the
calculations across multiple computers communicating over a shared
network.</li>
</ul>
<p>In all these cases, access to more (and larger) computers is needed.
Those computers should be usable at the same time, <strong>solving many
researchers’ problems in parallel</strong>.</p>
<section><h2 class="section-heading" id="jargon-busting-presentation">Jargon Busting Presentation<a class="anchor" aria-label="anchor" href="#jargon-busting-presentation"></a>
</h2>
<hr class="half-width">
<p>Open the <a href="%7B%7B%20site.url%20%7D%7Dfiles/jargon#p1">HPC
Jargon Buster</a> in a new tab. To present the content, press
<code>C</code> to open a <strong>c</strong>lone in a separate window,
then press <code>P</code> to toggle <strong>p</strong>resentation
mode.</p>
<div id="ive-never-used-a-server-have-i" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="ive-never-used-a-server-have-i" class="callout-inner">
<h3 class="callout-title">I’ve Never Used a Server, Have I?</h3>
<div class="callout-content">
<p>Take a minute and think about which of your daily interactions with a
computer may require a remote server or even cluster to provide you with
results.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Some Ideas
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<ul>
<li>Checking email: your computer (possibly in your pocket) contacts a
remote machine, authenticates, and downloads a list of new messages; it
also uploads changes to message status, such as whether you read, marked
as junk, or deleted the message. Since yours is not the only account,
the mail server is probably one of many in a data center.</li>
<li>Searching for a phrase online involves comparing your search term
against a massive database of all known sites, looking for matches. This
“query” operation can be straightforward, but building that database is
a <a href="https://en.wikipedia.org/wiki/MapReduce" class="external-link">monumental task</a>!
Servers are involved at every step.</li>
<li>Searching for directions on a mapping website involves connecting
your
<ol style="list-style-type: upper-alpha">
<li>starting and (B) end points by <a href="https://en.wikipedia.org/wiki/Dijkstra%27s_algorithm" class="external-link">traversing a
graph</a> in search of the “shortest” path by distance, time, expense,
or another metric. Converting a map into the right form is relatively
simple, but calculating all the possible routes between A and B is
expensive.</li>
</ol>
</li>
</ul>
<p>Checking email could be serial: your machine connects to one server
and exchanges data. Searching by querying the database for your search
term (or endpoints) could also be serial, in that one machine receives
your query and returns the result. However, assembling and storing the
full database is far beyond the capability of any one machine.
Therefore, these functions are served in parallel by a large, <a href="https://en.wikipedia.org/wiki/Hyperscale_computing" class="external-link">“hyperscale”</a>
collection of servers working together.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>High Performance Computing (HPC) typically involves connecting to
very large computing systems elsewhere in the world.</li>
<li>These other systems can be used to do work that would either be
impossible or much slower on smaller systems.</li>
<li>HPC resources are shared by multiple users.</li>
<li>The standard method of interacting with such systems is via a
command line interface.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-11-connecting"><p>Content from <a href="11-connecting.html">Connecting to a remote HPC system</a></p>
<hr>
<p>Last updated on 2024-09-26 |

        <a href="https://github.com/tobyhodges/probable-pancake/edit/main/episodes/11-connecting.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I log in to a remote HPC system?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Configure secure access to a remote HPC system.</li>
<li>Connect to a remote HPC system.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="secure-connections">Secure Connections<a class="anchor" aria-label="anchor" href="#secure-connections"></a>
</h2>
<hr class="half-width">
<p>The first step in using a cluster is to establish a connection from
our laptop to the cluster. When we are sitting at a computer (or
standing, or holding it in our hands or on our wrists), we have come to
expect a visual display with icons, widgets, and perhaps some windows or
applications: a <em>graphical user interface</em>, or GUI. Since
computer clusters are remote resources that we connect to over slow or
intermittent interfaces (WiFi and VPNs especially), it is more practical
to use a <em>command-line interface</em>, or CLI, to send commands as
plain-text. If a command returns output, it is printed as plain text as
well. The commands we run today will not open a window to show graphical
results.</p>
<p>If you have ever opened the Windows Command Prompt or macOS Terminal,
you have seen a CLI. If you have already taken The Carpentries’ courses
on the UNIX Shell or Version Control, you have used the CLI on your
<em>local machine</em> extensively. The only leap to be made here is to
open a CLI on a <em>remote machine</em>, while taking some precautions
so that other folks on the network can’t see (or change) the commands
you’re running or the results the remote machine sends back. We will use
the Secure SHell protocol (or SSH) to open an encrypted network
connection between two machines, allowing you to send &amp; receive text
and data without having to worry about prying eyes.</p>
<figure><img src="/fig/connect-to-remote.svg" max-width="50%" alt="Connect to cluster" class="figure mx-auto d-block"></figure><p>SSH clients are usually command-line tools, where you provide the
remote machine address as the only required argument. If your username
on the remote system differs from what you use locally, you must provide
that as well. If your SSH client has a graphical front-end, such as
PuTTY or MobaXterm, you will set these arguments before clicking
“connect.” From the terminal, you’ll write something like
<code>ssh userName@hostname</code>, where the argument is just like an
email address: the “@” symbol is used to separate the personal ID from
the address of the remote machine.</p>
<p>When logging in to a laptop, tablet, or other personal device, a
username, password, or pattern are normally required to prevent
unauthorized access. In these situations, the likelihood of somebody
else intercepting your password is low, since logging your keystrokes
requires a malicious exploit or physical access. For systems like {{
site.remote.host }} running an SSH server, anybody on the network can
log in, or try to. Since usernames are often public or easy to guess,
your password is often the weakest link in the security chain. Many
clusters therefore forbid password-based login, requiring instead that
you generate and configure a public-private key pair with a much
stronger password. Even if your cluster does not require it, the next
section will guide you through the use of SSH keys and an SSH agent to
both strengthen your security <em>and</em> make it more convenient to
log in to remote systems.</p>
<div class="section level3">
<h3 id="better-security-with-ssh-keys">Better Security With SSH Keys<a class="anchor" aria-label="anchor" href="#better-security-with-ssh-keys"></a>
</h3>
<p>The <a href="index.html#setup">Lesson Setup</a> provides instructions for
installing a shell application with SSH. If you have not done so
already, please open that shell application with a Unix-like command
line interface to your system.</p>
<p>SSH keys are an alternative method for authentication to obtain
access to remote computing systems. They can also be used for
authentication when transferring files or for accessing remote version
control systems (such as <a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh" class="external-link">GitHub</a>).
In this section you will create a pair of SSH keys:</p>
<ul>
<li>a private key which you keep on your own computer, and</li>
<li>a public key which can be placed on any remote system you will
access.</li>
</ul>
<blockquote>
<h2 id="private-keys-are-your-secure-digital-passport">Private keys are
your secure digital passport</h2>
<p>A private key that is visible to anyone but you should be considered
compromised, and must be destroyed. This includes having improper
permissions on the directory it (or a copy) is stored in, traversing any
network that is not secure (encrypted), attachment on unencrypted email,
and even displaying the key on your terminal window.</p>
<p>Protect this key as if it unlocks your front door. In many ways, it
does. {: .caution}</p>
</blockquote>
<p>Regardless of the software or operating system you use,
<em>please</em> choose a strong password or passphrase to act as another
layer of protection for your private SSH key.</p>
<div id="considerations-for-ssh-key-passwords" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="considerations-for-ssh-key-passwords" class="callout-inner">
<h3 class="callout-title">Considerations for SSH Key Passwords</h3>
<div class="callout-content">
<p>When prompted, enter a strong password that you will remember. There
are two common approaches to this:</p>
<ol style="list-style-type: decimal">
<li>Create a memorable passphrase with some punctuation and
number-for-letter substitutions, 32 characters or longer. Street
addresses work well; just be careful of social engineering or public
records attacks.</li>
<li>Use a password manager and its built-in password generator with all
character classes, 25 characters or longer. <a href="https://keepass.info" class="external-link">KeePass</a> and <a href="https://bitwarden.com" class="external-link">BitWarden</a> are two good options.</li>
<li>Nothing is <em>less</em> secure than a private key with no password.
If you skipped password entry by accident, go back and generate a new
key pair <em>with</em> a strong password.</li>
</ol>
</div>
</div>
</div>
<div class="section level4">
<h4 id="ssh-keys-on-linux-mac-mobaxterm-and-windows-subsystem-for-linux">SSH Keys on Linux, Mac, MobaXterm, and Windows Subsystem for
Linux<a class="anchor" aria-label="anchor" href="#ssh-keys-on-linux-mac-mobaxterm-and-windows-subsystem-for-linux"></a>
</h4>
<p>Once you have opened a terminal, check for existing SSH keys and
filenames since existing SSH keys are overwritten.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} ls ~/.ssh/</span></code></pre>
</div>
<p>If <code>~/.ssh/id_ed25519</code> already exists, you will need to
specify a different name for the new key-pair.</p>
<p>Generate a new public-private key pair using the following command,
which will produce a stronger key than the <code>ssh-keygen</code>
default by invoking these flags:</p>
<ul>
<li>
<code>-a</code> (default is 16): number of rounds of passphrase
derivation; increase to slow down brute force attacks.</li>
<li>
<code>-t</code> (default is <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)" class="external-link">rsa</a>):
specify the “type” or cryptographic algorithm. <code>ed25519</code>
specifies <a href="https://en.wikipedia.org/wiki/EdDSA" class="external-link">EdDSA</a> with a
256-bit key; it is faster than RSA with a comparable strength.</li>
<li>
<code>-f</code> (default is /home/user/.ssh/id_algorithm): filename
to store your private key. The public key filename will be identical,
with a <code>.pub</code> extension added.</li>
</ul>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} ssh-keygen <span class="at">-a</span> 100 <span class="at">-f</span> ~/.ssh/id_ed25519 <span class="at">-t</span> ed25519</span></code></pre>
</div>
<p>When prompted, enter a strong password with the <a href="#considerations-for-ssh-key-passwords">above considerations in
mind</a>. Note that the terminal will not appear to change while you
type the password: this is deliberate, for your security. You will be
prompted to type it again, so don’t worry too much about typos.</p>
<p>Take a look in <code>~/.ssh</code> (use <code>ls ~/.ssh</code>). You
should see two new files:</p>
<ul>
<li>your private key (<code>~/.ssh/id_ed25519</code>): <em>do not share
with anyone!</em>
</li>
<li>the shareable public key (<code>~/.ssh/id_ed25519.pub</code>): if a
system administrator asks for a key, this is the one to send. It is also
safe to upload to websites such as GitHub: it is meant to be seen.</li>
</ul>
<div id="use-rsa-for-older-systems" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="use-rsa-for-older-systems" class="callout-inner">
<h3 class="callout-title">Use RSA for Older Systems</h3>
<div class="callout-content">
<p>If key generation failed because ed25519 is not available, try using
the older (but still strong and trustworthy) <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)" class="external-link">RSA</a>
cryptosystem. Again, first check for an existing key:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} ls ~/.ssh/</span></code></pre>
</div>
<p>If <code>~/.ssh/id_rsa</code> already exists, you will need to
specify choose a different name for the new key-pair. Generate it as
above, with the following extra flags:</p>
<ul>
<li>
<code>-b</code> sets the number of bits in the key. The default is
2048. EdDSA uses a fixed key length, so this flag would have no
effect.</li>
<li>
<code>-o</code> (no default): use the OpenSSH key format, rather
than PEM.</li>
</ul>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} ssh-keygen <span class="at">-a</span> 100 <span class="at">-b</span> 4096 <span class="at">-f</span> ~/.ssh/id_rsa <span class="at">-o</span> <span class="at">-t</span> rsa</span></code></pre>
</div>
<p>When prompted, enter a strong password with the <a href="#considerations-for-ssh-key-passwords">above considerations in
mind</a>.</p>
<p>Take a look in <code>~/.ssh</code> (use <code>ls ~/.ssh</code>). You
should see two new files:</p>
<ul>
<li>your private key (<code>~/.ssh/id_rsa</code>): <em>do not share with
anyone!</em>
</li>
<li>the shareable public key (<code>~/.ssh/id_rsa.pub</code>): if a
system administrator asks for a key, this is the one to send. It is also
safe to upload to websites such as GitHub: it is meant to be seen.</li>
</ul>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="ssh-keys-on-putty">SSH Keys on PuTTY<a class="anchor" aria-label="anchor" href="#ssh-keys-on-putty"></a>
</h4>
<p>If you are using PuTTY on Windows, download and use
<code>puttygen</code> to generate the key pair. See the <a href="https://tartarus.org/~simon/putty-prerel-snapshots/htmldoc/Chapter8.html#pubkey-puttygen" class="external-link">PuTTY
documentation</a> for details.</p>
<ul>
<li>Select <code>EdDSA</code> as the key type.</li>
<li>Select <code>255</code> as the key size or strength.</li>
<li>Click on the “Generate” button.</li>
<li>You do not need to enter a comment.</li>
<li>When prompted, enter a strong password with the <a href="#considerations-for-ssh-key-passwords">above considerations in
mind</a>.</li>
<li>Save the keys in a folder no other users of the system can
read.</li>
</ul>
<p>Take a look in the folder you specified. You should see two new
files:</p>
<ul>
<li>your private key (<code>id_ed25519</code>): <em>do not share with
anyone!</em>
</li>
<li>the shareable public key (<code>id_ed25519.pub</code>): if a system
administrator asks for a key, this is the one to send. It is also safe
to upload to websites such as GitHub: it is meant to be seen.</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="ssh-agent-for-easier-key-handling">SSH Agent for Easier Key Handling<a class="anchor" aria-label="anchor" href="#ssh-agent-for-easier-key-handling"></a>
</h3>
<p>An SSH key is only as strong as the password used to unlock it, but
on the other hand, typing out a complex password every time you connect
to a machine is tedious and gets old very fast. This is where the <a href="https://www.ssh.com/academy/ssh/agent" class="external-link">SSH Agent</a> comes in.</p>
<p>Using an SSH Agent, you can type your password for the private key
once, then have the Agent remember it for some number of hours or until
you log off. Unless some nefarious actor has physical access to your
machine, this keeps the password safe, and removes the tedium of
entering the password multiple times.</p>
<p>Just remember your password, because once it expires in the Agent,
you have to type it in again.</p>
<div class="section level4">
<h4 id="ssh-agents-on-linux-macos-and-windows">SSH Agents on Linux, macOS, and Windows<a class="anchor" aria-label="anchor" href="#ssh-agents-on-linux-macos-and-windows"></a>
</h4>
<p>Open your terminal application and check if an agent is running:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} ssh-add <span class="at">-l</span></span></code></pre>
</div>
<ul>
<li>
<p>If you get an error like this one,</p>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error connecting to agent: No such file or directory</code></pre>
</div>
<p>… then you need to launch the agent as follows:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} eval <span class="va">$(</span><span class="fu">ssh-agent</span><span class="va">)</span></span></code></pre>
</div>
<div id="callout3" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">What’s in a
<code>$(...)</code>?</h3>
<div class="callout-content">
<p>The syntax of this SSH Agent command is unusual, based on what we’ve
seen in the UNIX Shell lesson. This is because the
<code>ssh-agent</code> command creates opens a connection that only you
have access to, and prints a series of shell commands that can be used
to reach it – but <em>does not execute them!</em></p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} ssh-agent</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>SSH_AUTH_SOCK=/tmp/ssh-Zvvga2Y8kQZN/agent.131521;
export SSH_AUTH_SOCK;
SSH_AGENT_PID=131522;
export SSH_AGENT_PID;
echo Agent pid 131522;</code></pre>
</div>
<p>The <code>eval</code> command interprets this text output as commands
and allows you to access the SSH Agent connection you just created.</p>
<p>You could run each line of the <code>ssh-agent</code> output
yourself, and achieve the same result. Using <code>eval</code> just
makes this easier.</p>
</div>
</div>
</div>
</li>
<li><p>Otherwise, your agent is already running: don’t mess with
it.</p></li>
</ul>
<p>Add your key to the agent, with session expiration after 8 hours:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} ssh-add <span class="at">-t</span> 8h ~/.ssh/id_ed25519</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Enter passphrase for .ssh/id_ed25519:
Identity added: .ssh/id_ed25519
Lifetime set to 86400 seconds</code></pre>
</div>
<p>For the duration (8 hours), whenever you use that key, the SSH Agent
will provide the key on your behalf without you having to type a single
keystroke.</p>
</div>
<div class="section level4">
<h4 id="ssh-agent-on-putty">SSH Agent on PuTTY<a class="anchor" aria-label="anchor" href="#ssh-agent-on-putty"></a>
</h4>
<p>If you are using PuTTY on Windows, download and use
<code>pageant</code> as the SSH agent. See the <a href="https://tartarus.org/~simon/putty-prerel-snapshots/htmldoc/Chapter9.html#pageant" class="external-link">PuTTY
documentation</a>.</p>
</div>
</div>
<div class="section level3">
<h3 id="transfer-your-public-key">Transfer Your Public Key<a class="anchor" aria-label="anchor" href="#transfer-your-public-key"></a>
</h3>
<p>{% if site.remote.portal %} Visit <a href="%7B%7B%20site.remote.portal%20%7D%7D">{{ site.remote.portal }}</a>
to upload your SSH public key. (Remember, it’s the one ending in
<code>.pub</code>!)</p>
<p>{% else %} Use the <strong>s</strong>ecure
<strong>c</strong>o<strong>p</strong>y tool to send your public key to
the cluster.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} scp ~/.ssh/id_ed25519.pub {{ site.remote.user }}@{{ site.remote.login }}:~/</span></code></pre>
</div>
<p>{% endif %}</p>
</div>
</section><section><h2 class="section-heading" id="log-in-to-the-cluster">Log In to the Cluster<a class="anchor" aria-label="anchor" href="#log-in-to-the-cluster"></a>
</h2>
<hr class="half-width">
<p>Go ahead and open your terminal or graphical SSH client, then log in
to the cluster. Replace <code>{{ site.remote.user }}</code> with your
username or the one supplied by the instructors.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} ssh {{ site.remote.user }}@{{ site.remote.login }}</span></code></pre>
</div>
<p>You may be asked for your password. Watch out: the characters you
type after the password prompt are not displayed on the screen. Normal
output will resume once you press <code>Enter</code>.</p>
<p>You may have noticed that the prompt changed when you logged into the
remote system using the terminal (if you logged in using PuTTY this will
not apply because it does not offer a local terminal). This change is
important because it can help you distinguish on which system the
commands you type will be run when you pass them into the terminal. This
change is also a small complication that we will need to navigate
throughout the workshop. Exactly what is displayed as the prompt (which
conventionally ends in <code>$</code>) in the terminal when it is
connected to the local system and the remote system will typically be
different for every user. We still need to indicate which system we are
entering commands on though so we will adopt the following
convention:</p>
<ul>
<li>
<code>{{ site.local.prompt }}</code> when the command is to be
entered on a terminal connected to your local computer</li>
<li>
<code>{{ site.remote.prompt }}</code> when the command is to be
entered on a terminal connected to the remote system</li>
<li>
<code>$</code> when it really doesn’t matter which system the
terminal is connected to.</li>
</ul></section><section><h2 class="section-heading" id="looking-around-your-remote-home">Looking Around Your Remote Home<a class="anchor" aria-label="anchor" href="#looking-around-your-remote-home"></a>
</h2>
<hr class="half-width">
<p>Very often, many users are tempted to think of a high-performance
computing installation as one giant, magical machine. Sometimes, people
will assume that the computer they’ve logged onto is the entire
computing cluster. So what’s really happening? What computer have we
logged on to? The name of the current computer we are logged onto can be
checked with the <code>hostname</code> command. (You may also notice
that the current hostname is also part of our prompt!)</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} hostname</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="op">{</span><span class="op">{</span> <span class="va">site.remote.host</span> <span class="op">}</span><span class="op">}</span></span></code></pre>
</div>
<p>So, we’re definitely on the remote machine. Next, let’s find out
where we are by running <code>pwd</code> to <strong>p</strong>rint the
<strong>w</strong>orking <strong>d</strong>irectory.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} pwd</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="op">{</span><span class="op">{</span> <span class="va">site.remote.homedir</span> <span class="op">}</span><span class="op">}</span><span class="op">/</span><span class="op">{</span><span class="op">{</span> <span class="va">site.remote.user</span> <span class="op">}</span><span class="op">}</span></span></code></pre>
</div>
<p>Great, we know where we are! Let’s see what’s in our current
directory:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} ls</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">id_ed25519.pub</span></span></code></pre>
</div>
<p>The system administrators may have configured your home directory
with some helpful files, folders, and links (shortcuts) to space
reserved for you on other filesystems. If they did not, your home
directory may appear empty. To double-check, include hidden files in
your directory listing:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} ls <span class="at">-a</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  .            .bashrc           id_ed25519.pub
  ..           .ssh</code></pre>
</div>
<p>In the first column, <code>.</code> is a reference to the current
directory and <code>..</code> a reference to its parent
(<code>{{ site.remote.homedir }}</code>). You may or may not see the
other files, or files like them: <code>.bashrc</code> is a shell
configuration file, which you can edit with your preferences; and
<code>.ssh</code> is a directory storing SSH keys and a record of
authorized connections.</p>
<p>{% unless site.remote.portal %}</p>
<div class="section level3">
<h3 id="install-your-ssh-key">Install Your SSH Key<a class="anchor" aria-label="anchor" href="#install-your-ssh-key"></a>
</h3>
<div id="there-may-be-a-better-way" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="there-may-be-a-better-way" class="callout-inner">
<h3 class="callout-title">There May Be a Better Way</h3>
<div class="callout-content">
<p>Policies and practices for handling SSH keys vary between HPC
clusters: follow any guidance provided by the cluster administrators or
documentation. In particular, if there is an online portal for managing
SSH keys, use that instead of the directions outlined here.</p>
</div>
</div>
</div>
<p>If you transferred your SSH public key with <code>scp</code>, you
should see <code>id_ed25519.pub</code> in your home directory. To
“install” this key, it must be listed in a file named
<code>authorized_keys</code> under the <code>.ssh</code> folder.</p>
<p>If the <code>.ssh</code> folder was not listed above, then it does
not yet exist: create it.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} mkdir ~/.ssh</span></code></pre>
</div>
<p>Now, use <code>cat</code> to print your public key, but redirect the
output, appending it to the <code>authorized_keys</code> file:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} cat ~/id_ed25519.pub <span class="op">&gt;&gt;</span> ~/.ssh/authorized_keys</span></code></pre>
</div>
<p>That’s all! Disconnect, then try to log back into the remote: if your
key and agent have been configured correctly, you should not be prompted
for the password for your SSH key.</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} logout</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} ssh {{ site.remote.user }}@{{ site.remote.login }}</span></code></pre>
</div>
<p>{% endunless %}</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>An HPC system is a set of networked machines.</li>
<li>HPC systems typically provide login nodes and a set of worker
nodes.</li>
<li>The resources found on independent (worker) nodes can vary in volume
and type (amount of RAM, processor architecture, availability of network
mounted filesystems, etc.).</li>
<li>Files saved on one node are available on all nodes.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-12-cluster"><p>Content from <a href="12-cluster.html">Exploring Remote Resources</a></p>
<hr>
<p>Last updated on 2024-09-26 |

        <a href="https://github.com/tobyhodges/probable-pancake/edit/main/episodes/12-cluster.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How does my local computer compare to the remote systems?</li>
<li>How does the login node compare to the compute nodes?</li>
<li>Are all compute nodes alike?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Survey system resources using <code>nproc</code>, <code>free</code>,
and the queuing system</li>
<li>Compare &amp; contrast resources on the local machine, login node,
and worker nodes</li>
<li>Learn about the various filesystems on the cluster using
<code>df</code>
</li>
<li>Find out <code>who</code> else is logged in</li>
<li>Assess the number of idle and occupied nodes</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="look-around-the-remote-system">Look Around the Remote System<a class="anchor" aria-label="anchor" href="#look-around-the-remote-system"></a>
</h2>
<hr class="half-width">
<p>If you have not already connected to {{ site.remote.name }}, please
do so now:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }}  ssh {{ site.remote.user }}@{{ site.remote.login }}</span></code></pre>
</div>
<p>Take a look at your home directory on the remote system:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} ls</span></code></pre>
</div>
<div id="whats-different-between-your-machine-and-the-remote" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="whats-different-between-your-machine-and-the-remote" class="callout-inner">
<h3 class="callout-title">What’s different between your machine and the remote?</h3>
<div class="callout-content">
<p>Open a second terminal window on your local computer and run the
<code>ls</code> command (without logging in to {{ site.remote.name }}).
What differences do you see?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>You would likely see something more like this:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} ls</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Applications Documents    Library      Music        Public
Desktop      Downloads    Movies       Pictures</code></pre>
</div>
<p>The remote computer’s home directory shares almost nothing in common
with the local computer: they are completely separate systems!</p>
</div>
</div>
</div>
</div>
<p>Most high-performance computing systems run the Linux operating
system, which is built around the UNIX <a href="https://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard" class="external-link">Filesystem
Hierarchy Standard</a>. Instead of having a separate root for each hard
drive or storage medium, all files and devices are anchored to the
“root” directory, which is <code>/</code>:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} ls /</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>bin   etc   lib64  proc  sbin     sys  var
boot  {{ site.remote.homedir | replace: "/", "" }}  mnt    root  scratch  tmp  working
dev   lib   opt    run   srv      usr</code></pre>
</div>
<p>The “{{ site.remote.homedir | replace:”/“,”” }}” directory is the one
where we generally want to keep all of our files. Other folders on a
UNIX OS contain system files and change as you install new software or
upgrade your OS.</p>
<div id="using-hpc-filesystems" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="using-hpc-filesystems" class="callout-inner">
<h3 class="callout-title">Using HPC filesystems</h3>
<div class="callout-content">
<p>On HPC systems, you have a number of places where you can store your
files. These differ in both the amount of space allocated and whether or
not they are backed up.</p>
<ul>
<li>
<strong>Home</strong> – often a <em>network filesystem</em>, data
stored here is available throughout the HPC system, and often backed up
periodically. Files stored here are typically slower to access, the data
is actually stored on another computer and is being transmitted and made
available over the network!</li>
<li>
<strong>Scratch</strong> – typically faster than the networked Home
directory, but not usually backed up, and should not be used for long
term storage.</li>
<li>
<strong>Work</strong> – sometimes provided as an alternative to
Scratch space, Work is a fast file system accessed over the network.
Typically, this will have higher performance than your home directory,
but lower performance than Scratch; it may not be backed up. It differs
from Scratch space in that files in a work file system are not
automatically deleted for you: you must manage the space yourself.</li>
</ul>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="nodes">Nodes<a class="anchor" aria-label="anchor" href="#nodes"></a>
</h2>
<hr class="half-width">
<p>Individual computers that compose a cluster are typically called
<em>nodes</em> (although you will also hear people call them
<em>servers</em>, <em>computers</em> and <em>machines</em>). On a
cluster, there are different types of nodes for different types of
tasks. The node where you are right now is called the <em>login
node</em>, <em>head node</em>, <em>landing pad</em>, or <em>submit
node</em>. A login node serves as an access point to the cluster.</p>
<p>As a gateway, the login node should not be used for time-consuming or
resource-intensive tasks. You should be alert to this, and check with
your site’s operators or documentation for details of what is and isn’t
allowed. It is well suited for uploading and downloading files, setting
up software, and running tests. Generally speaking, in these lessons, we
will avoid running jobs on the login node.</p>
<p>Who else is logged in to the login node?</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} who</span></code></pre>
</div>
<p>This may show only your user ID, but there are likely several other
people (including fellow learners) connected right now.</p>
<div id="dedicated-transfer-nodes" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="dedicated-transfer-nodes" class="callout-inner">
<h3 class="callout-title">Dedicated Transfer Nodes</h3>
<div class="callout-content">
<p>If you want to transfer larger amounts of data to or from the
cluster, some systems offer dedicated nodes for data transfers only. The
motivation for this lies in the fact that larger data transfers should
not obstruct operation of the login node for anybody else. Check with
your cluster’s documentation or its support team if such a transfer node
is available. As a rule of thumb, consider all transfers of a volume
larger than 500 MB to 1 GB as large. But these numbers change, e.g.,
depending on the network connection of yourself and of your cluster or
other factors.</p>
</div>
</div>
</div>
<p>The real work on a cluster gets done by the <em>compute</em> (or
<em>worker</em>) <em>nodes</em>. compute nodes come in many shapes and
sizes, but generally are dedicated to long or hard tasks that require a
lot of computational resources.</p>
<p>All interaction with the compute nodes is handled by a specialized
piece of software called a scheduler (the scheduler used in this lesson
is called {{ site.sched.name }}). We’ll learn more about how to use the
scheduler to submit jobs next, but for now, it can also tell us more
information about the compute nodes.</p>
<p>For example, we can view all of the compute nodes by running the
command <code>{{ site.sched.info }}</code>.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.info }}</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>PARTITION          AVAIL  TIMELIMIT  NODES  STATE NODELIST
cpubase_bycore_b1*    up   infinite      4   idle node[1-2],smnode[1-2]
node                  up   infinite      2   idle node[1-2]
smnode                up   infinite      2   idle smnode[1-2]</code></pre>
</div>
<p>A lot of the nodes are busy running work for other users: we are not
alone here!</p>
<p>There are also specialized machines used for managing disk storage,
user authentication, and other infrastructure-related tasks. Although we
do not typically logon to or interact with these machines directly, they
enable a number of key features like ensuring our user account and files
are available throughout the HPC system.</p>
</section><section><h2 class="section-heading" id="whats-in-a-node">What’s in a Node?<a class="anchor" aria-label="anchor" href="#whats-in-a-node"></a>
</h2>
<hr class="half-width">
<p>All of the nodes in an HPC system have the same components as your
own laptop or desktop: <em>CPUs</em> (sometimes also called
<em>processors</em> or <em>cores</em>), <em>memory</em> (or
<em>RAM</em>), and <em>disk</em> space. CPUs are a computer’s tool for
actually running programs and calculations. Information about a current
task is stored in the computer’s memory. Disk refers to all storage that
can be accessed like a file system. This is generally storage that can
hold data permanently, i.e. data is still there even if the computer has
been restarted. While this storage can be local (a hard drive installed
inside of it), it is more common for nodes to connect to a shared,
remote fileserver or cluster of servers.</p>
<figure><img src="/fig/node_anatomy.png" max-width="40%" alt="Node anatomy" class="figure mx-auto d-block"></figure><div id="explore-your-computer" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="explore-your-computer" class="callout-inner">
<h3 class="callout-title">Explore Your Computer</h3>
<div class="callout-content">
<p>Try to find out the number of CPUs and amount of memory available on
your personal computer.</p>
<p>Note that, if you’re logged in to the remote computer cluster, you
need to log out first. To do so, type <code>Ctrl+d</code> or
<code>exit</code>:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} exit</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }}</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>There are several ways to do this. Most operating systems have a
graphical system monitor, like the Windows Task Manager. More detailed
information can be found on the command line:</p>
<ul>
<li>
<p>Run system utilities</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} nproc <span class="at">--all</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} free <span class="at">-m</span></span></code></pre>
</div>
</li>
<li>
<p>Read from <code>/proc</code></p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} cat /proc/cpuinfo</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} cat /proc/meminfo</span></code></pre>
</div>
</li>
<li>
<p>Run system monitor</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} htop</span></code></pre>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="explore-the-login-node" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="explore-the-login-node" class="callout-inner">
<h3 class="callout-title">Explore the Login Node</h3>
<div class="callout-content">
<p>Now compare the resources of your computer with those of the login
node.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} ssh {{ site.remote.user }}@{{ site.remote.login }}</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} nproc <span class="at">--all</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} free <span class="at">-m</span></span></code></pre>
</div>
<p>You can get more information about the processors using
<code>lscpu</code>, and a lot of detail about the memory by reading the
file <code>/proc/meminfo</code>:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} less /proc/meminfo</span></code></pre>
</div>
<p>You can also explore the available filesystems using <code>df</code>
to show <strong>d</strong>isk <strong>f</strong>ree space. The
<code>-h</code> flag renders the sizes in a human-friendly format, i.e.,
GB instead of B. The <strong>t</strong>ype flag <code>-T</code> shows
what kind of filesystem each resource is.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} df <span class="at">-Th</span></span></code></pre>
</div>
<div id="different-results-from-df" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="different-results-from-df" class="callout-inner">
<h3 class="callout-title">Different results from <code>df</code>
</h3>
<div class="callout-content">
<ul>
<li>The local filesystems (ext, tmp, xfs, zfs) will depend on whether
you’re on the same login node (or compute node, later on).</li>
<li>Networked filesystems (beegfs, cifs, gpfs, nfs, pvfs) will be
similar -- but may include {{ site.remote.user }}, depending on how it
is <a href="https://en.wikipedia.org/wiki/Mount_(computing)" class="external-link">mounted</a>.</li>
</ul>
</div>
</div>
</div>
<div id="shared-filesystems" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="shared-filesystems" class="callout-inner">
<h3 class="callout-title">Shared Filesystems</h3>
<div class="callout-content">
<p>This is an important point to remember: files saved on one node
(computer) are often available everywhere on the cluster!</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="explore-a-worker-node" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="explore-a-worker-node" class="callout-inner">
<h3 class="callout-title">Explore a Worker Node</h3>
<div class="callout-content">
<p>Finally, let’s look at the resources available on the worker nodes
where your jobs will actually run. Try running this command to see the
name, CPUs and memory available on the worker nodes:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} sinfo <span class="at">-o</span> <span class="st">"%n %c %m"</span> <span class="kw">|</span> <span class="ex">column</span> <span class="at">-t</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="compare-your-computer-the-login-node-and-the-compute-node" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="compare-your-computer-the-login-node-and-the-compute-node" class="callout-inner">
<h3 class="callout-title">Compare Your Computer, the Login Node and the Compute Node</h3>
<div class="callout-content">
<p>Compare your laptop’s number of processors and memory with the
numbers you see on the cluster login node and compute node. What
implications do you think the differences might have on running your
research work on the different systems and nodes?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>Compute nodes are usually built with processors that have <em>higher
core-counts</em> than the login node or personal computers in order to
support highly parallel tasks. Compute nodes usually also have
substantially <em>more memory (RAM)</em> installed than a personal
computer. More cores tends to help jobs that depend on some work that is
easy to perform in <em>parallel</em>, and more, faster memory is key for
large or <em>complex numerical tasks</em>.</p>
</div>
</div>
</div>
</div>
<div id="differences-between-nodes" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="differences-between-nodes" class="callout-inner">
<h3 class="callout-title">Differences Between Nodes</h3>
<div class="callout-content">
<p>Many HPC clusters have a variety of nodes optimized for particular
workloads. Some nodes may have larger amount of memory, or specialized
resources such as Graphics Processing Units (GPUs or “video cards”).</p>
</div>
</div>
</div>
<p>With all of this in mind, we will now cover how to talk to the
cluster’s scheduler, and use it to start running our scripts and
programs!</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>An HPC system is a set of networked machines.</li>
<li>HPC systems typically provide login nodes and a set of compute
nodes.</li>
<li>The resources found on independent (worker) nodes can vary in volume
and type (amount of RAM, processor architecture, availability of network
mounted filesystems, etc.).</li>
<li>Files saved on shared storage are available on all nodes.</li>
<li>The login node is a shared machine: be considerate of other
users.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-13-scheduler"><p>Content from <a href="13-scheduler.html">Scheduler Fundamentals</a></p>
<hr>
<p>Last updated on 2024-09-26 |

        <a href="https://github.com/tobyhodges/probable-pancake/edit/main/episodes/13-scheduler.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is a scheduler and why does a cluster need one?</li>
<li>How do I launch a program to run on a compute node in the
cluster?</li>
<li>How do I capture the output of a program that is run on a node in
the cluster?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Submit a simple script to the cluster.</li>
<li>Monitor the execution of jobs using command line tools.</li>
<li>Inspect the output and error files of your jobs.</li>
<li>Find the right place to put large datasets on the cluster.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="job-scheduler">Job Scheduler<a class="anchor" aria-label="anchor" href="#job-scheduler"></a>
</h2>
<hr class="half-width">
<p>An HPC system might have thousands of nodes and thousands of users.
How do we decide who gets what and when? How do we ensure that a task is
run with the resources it needs? This job is handled by a special piece
of software called the <em>scheduler</em>. On an HPC system, the
scheduler manages which jobs run where and when.</p>
<p>The following illustration compares these tasks of a job scheduler to
a waiter in a restaurant. If you can relate to an instance where you had
to wait for a while in a queue to get in to a popular restaurant, then
you may now understand why sometimes your job do not start instantly as
in your laptop.</p>
<figure><img src="/fig/restaurant_queue_manager.svg" alt="Compare a job scheduler to a waiter in a restaurant" max-width="75%" class="figure mx-auto d-block"></figure><p>The scheduler used in this lesson is {{ site.sched.name }}. Although
{{ site.sched.name }} is not used everywhere, running jobs is quite
similar regardless of what software is being used. The exact syntax
might change, but the concepts remain the same.</p>
</section><section><h2 class="section-heading" id="running-a-batch-job">Running a Batch Job<a class="anchor" aria-label="anchor" href="#running-a-batch-job"></a>
</h2>
<hr class="half-width">
<p>The most basic use of the scheduler is to run a command
non-interactively. Any command (or series of commands) that you want to
run on the cluster is called a <em>job</em>, and the process of using a
scheduler to run the job is called <em>batch job submission</em>.</p>
<p>In this case, the job we want to run is a shell script – essentially
a text file containing a list of UNIX commands to be executed in a
sequential manner. Our shell script will have three parts:</p>
<ul>
<li>On the very first line, add
<code>{{ site.remote.bash_shebang }}</code>. The <code>#!</code>
(pronounced “hash-bang” or “shebang”) tells the computer what program is
meant to process the contents of this file. In this case, we are telling
it that the commands that follow are written for the command-line shell
(what we’ve been doing everything in so far).</li>
<li>Anywhere below the first line, we’ll add an <code>echo</code>
command with a friendly greeting. When run, the shell script will print
whatever comes after <code>echo</code> in the terminal.
<ul>
<li>
<code>echo -n</code> will print everything that follows,
<em>without</em> ending the line by printing the new-line
character.</li>
</ul>
</li>
<li>On the last line, we’ll invoke the <code>hostname</code> command,
which will print the name of the machine the script is run on.</li>
</ul>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} nano example-job.sh</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{{ site.remote.bash_shebang }}

echo -n "This script is running on "
hostname</code></pre>
</div>
<div id="creating-our-test-job" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="creating-our-test-job" class="callout-inner">
<h3 class="callout-title">Creating Our Test Job</h3>
<div class="callout-content">
<p>Run the script. Does it execute on the cluster or just our login
node?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} bash example-job.sh</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>This script is running on {{ site.remote.host }}</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>This script ran on the login node, but we want to take advantage of
the compute nodes: we need the scheduler to queue up
<code>example-job.sh</code> to run on a compute node.</p>
<p>To submit this task to the scheduler, we use the
<code>{{ site.sched.submit.name }}</code> command. This creates a
<em>job</em> which will run the <em>script</em> when <em>dispatched</em>
to a compute node which the queuing system has identified as being
available to perform the work.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.submit.name }} {% if site.sched.submit.options != <span class="st">''</span> %}{{ site.sched.submit.options }} {% endif %}example-job.sh</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Submitted batch job 9</code></pre>
</div>
<p>And that’s all we need to do to submit a job. Our work is done – now
the scheduler takes over and tries to run the job for us. While the job
is waiting to run, it goes into a list of jobs called the
<em>queue</em>. To check on our job’s status, we check the queue using
the command
<code>{{ site.sched.status }} {{ site.sched.flag.user }}</code>.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.status }} {{ site.sched.flag.user }}</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
    9 cpubase_b example-   user01  R       0:05      1 node1</code></pre>
</div>
<p>We can see all the details of our job, most importantly that it is in
the <code>R</code> or <code>RUNNING</code> state. Sometimes our jobs
might need to wait in a queue (<code>PENDING</code>) or have an error
(<code>E</code>).</p>
<div id="wheres-the-output" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="wheres-the-output" class="callout-inner">
<h3 class="callout-title">Where’s the Output?</h3>
<div class="callout-content">
<p>On the login node, this script printed output to the terminal – but
now, when <code>{{ site.sched.status }}</code> shows the job has
finished, nothing was printed to the terminal.</p>
<p>Cluster job output is typically redirected to a file in the directory
you launched it from. Use <code>ls</code> to find and <code>cat</code>
to read the file.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="customising-a-job">Customising a Job<a class="anchor" aria-label="anchor" href="#customising-a-job"></a>
</h2>
<hr class="half-width">
<p>The job we just ran used all of the scheduler’s default options. In a
real-world scenario, that’s probably not what we want. The default
options represent a reasonable minimum. Chances are, we will need more
cores, more memory, more time, among other special considerations. To
get access to these resources we must customize our job script.</p>
<p>Comments in UNIX shell scripts (denoted by <code>#</code>) are
typically ignored, but there are exceptions. For instance the special
<code>#!</code> comment at the beginning of scripts specifies what
program should be used to run it (you’ll typically see
<code>{{ site.local.bash_shebang }}</code>). Schedulers like {{
site.sched.name }} also have a special comment used to denote special
scheduler-specific options. Though these comments differ from scheduler
to scheduler, {{ site.sched.name }}’s special comment is
<code>{{ site.sched.comment }}</code>. Anything following the
<code>{{ site.sched.comment }}</code> comment is interpreted as an
instruction to the scheduler.</p>
<p>Let’s illustrate this by example. By default, a job’s name is the
name of the script, but the <code>{{ site.sched.flag.name }}</code>
option can be used to change the name of a job. Add an option to the
script:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} cat example-job.sh</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{{ site.remote.bash_shebang }}
{{ site.sched.comment }} {{ site.sched.flag.name }} hello-world

echo -n "This script is running on "
hostname</code></pre>
</div>
<p>Submit the job and monitor its status:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.submit.name }} {% if site.sched.submit.options != <span class="st">''</span> %}{{ site.sched.submit.options }} {% endif %}example-job.sh</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.status }} {{ site.sched.flag.user }}</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
   10 cpubase_b hello-wo   user01  R       0:02      1 node1</code></pre>
</div>
<p>Fantastic, we’ve successfully changed the name of our job!</p>
<div class="section level3">
<h3 id="resource-requests">Resource Requests<a class="anchor" aria-label="anchor" href="#resource-requests"></a>
</h3>
<p>What about more important changes, such as the number of cores and
memory for our jobs? One thing that is absolutely critical when working
on an HPC system is specifying the resources required to run a job. This
allows the scheduler to find the right time and place to schedule our
job. If you do not specify requirements (such as the amount of time you
need), you will likely be stuck with your site’s default resources,
which is probably not what you want.</p>
<p>The following are several key resource requests:</p>
<ul>
<li><p><code>--ntasks=&lt;ntasks&gt;</code> or
<code>-n &lt;ntasks&gt;</code>: How many CPU cores does your job need,
in total?</p></li>
<li><p><code>--time &lt;days-hours:minutes:seconds&gt;</code> or
<code>-t &lt;days-hours:minutes:seconds&gt;</code>: How much real-world
time (walltime) will your job take to run? The <code>&lt;days&gt;</code>
part can be omitted.</p></li>
<li><p><code>--mem=&lt;megabytes&gt;</code>: How much memory on a node
does your job need in megabytes? You can also specify gigabytes using by
adding a little “g” afterwards (example: <code>--mem=5g</code>)</p></li>
<li><p><code>--nodes=&lt;nnodes&gt;</code> or
<code>-N &lt;nnodes&gt;</code>: How many separate machines does your job
need to run on? Note that if you set <code>ntasks</code> to a number
greater than what one machine can offer, {{ site.sched.name }} will set
this value automatically.</p></li>
</ul>
<p>Note that just <em>requesting</em> these resources does not make your
job run faster, nor does it necessarily mean that you will consume all
of these resources. It only means that these are made available to you.
Your job may end up using less memory, or less time, or fewer nodes than
you have requested, and it will still run.</p>
<p>It’s best if your requests accurately reflect your job’s
requirements. We’ll talk more about how to make sure that you’re using
resources effectively in a later episode of this lesson.</p>
<div id="submitting-resource-requests" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="submitting-resource-requests" class="callout-inner">
<h3 class="callout-title">Submitting Resource Requests</h3>
<div class="callout-content">
<p>Modify our <code>hostname</code> script so that it runs for a minute,
then submit a job for it on the cluster.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} cat example-job.sh</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{{ site.remote.bash_shebang }}
{{ site.sched.comment }} {{ site.sched.flag.time }} 00:01 # timeout in HH:MM

echo -n "This script is running on "
sleep 20 # time in seconds
hostname</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.submit.name }} {% if site.sched.submit.options != <span class="st">''</span> %}{{ site.sched.submit.options }} {% endif %}example-job.sh</span></code></pre>
</div>
<p>Why are the {{ site.sched.name }} runtime and <code>sleep</code> time
not identical?</p>
</div>
</div>
</div>
</div>
<p>Resource requests are typically binding. If you exceed them, your job
will be killed. Let’s use wall time as an example. We will request 1
minute of wall time, and attempt to run a job for two minutes.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} cat example-job.sh</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{{ site.remote.bash_shebang }}
{{ site.sched.comment }} {{ site.sched.flag.name }} long_job
{{ site.sched.comment }} {{ site.sched.flag.time }} 00:01 # timeout in HH:MM

echo "This script is running on ... "
sleep 240 # time in seconds
hostname</code></pre>
</div>
<p>Submit the job and wait for it to finish. Once it is has finished,
check the log file.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.submit.name }} {% if site.sched.submit.options != <span class="st">''</span> %}{{ site.sched.submit.options }} {% endif %}example-job.sh</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.status }} {{ site.sched.flag.user }}</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} cat slurm-12.out</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>This script is running on ...
slurmstepd: error: *** JOB 12 ON node1 CANCELLED AT 2021-02-19T13:55:57
DUE TO TIME LIMIT ***</code></pre>
</div>
<p>Our job was killed for exceeding the amount of resources it
requested. Although this appears harsh, this is actually a feature.
Strict adherence to resource requests allows the scheduler to find the
best possible place for your jobs. Even more importantly, it ensures
that another user cannot use more resources than they’ve been given. If
another user messes up and accidentally attempts to use all of the cores
or memory on a node, {{ site.sched.name }} will either restrain their
job to the requested resources or kill the job outright. Other jobs on
the node will be unaffected. This means that one user cannot mess up the
experience of others, the only jobs affected by a mistake in scheduling
will be their own.</p>
</div>
</section><section><h2 class="section-heading" id="cancelling-a-job">Cancelling a Job<a class="anchor" aria-label="anchor" href="#cancelling-a-job"></a>
</h2>
<hr class="half-width">
<p>Sometimes we’ll make a mistake and need to cancel a job. This can be
done with the <code>{{ site.sched.del }}</code> command. Let’s submit a
job and then cancel it using its job number (remember to change the
walltime so that it runs long enough for you to cancel it before it is
killed!).</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.submit.name }} {% if site.sched.submit.options != <span class="st">''</span> %}{{ site.sched.submit.options }} {% endif %}example-job.sh</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.status }} {{ site.sched.flag.user }}</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Submitted batch job 13

JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
   13 cpubase_b long_job   user01  R       0:02      1 node1</code></pre>
</div>
<p>Now cancel the job with its job number (printed in your terminal). A
clean return of your command prompt indicates that the request to cancel
the job was successful.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{site.sched.del }} 38759</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="co"># It might take a minute for the job to disappear from the queue...</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.status }} {{ site.sched.flag.user }}</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)</code></pre>
</div>
<div id="cancelling-multiple-jobs" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="cancelling-multiple-jobs" class="callout-inner">
<h3 class="callout-title">Cancelling multiple jobs</h3>
<div class="callout-content">
<p>We can also cancel all of our jobs at once using the <code>-u</code>
option. This will delete all jobs for a specific user (in this case,
yourself). Note that you can only delete your own jobs.</p>
<p>Try submitting multiple jobs and then cancelling them all.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>First, submit a trio of jobs:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.submit.name }} {% if site.sched.submit.options != <span class="st">''</span> %}{{ site.sched.submit.options }} {% endif %}example-job.sh</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.submit.name }} {% if site.sched.submit.options != <span class="st">''</span> %}{{ site.sched.submit.options }} {% endif %}example-job.sh</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.submit.name }} {% if site.sched.submit.options != <span class="st">''</span> %}{{ site.sched.submit.options }} {% endif %}example-job.sh</span></code></pre>
</div>
<p>Then, cancel them all:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.del }} <span class="at">-u</span> {{ site.remote.user }}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="other-types-of-jobs">Other Types of Jobs<a class="anchor" aria-label="anchor" href="#other-types-of-jobs"></a>
</h2>
<hr class="half-width">
<p>Up to this point, we’ve focused on running jobs in batch mode. {{
site.sched.name }} also provides the ability to start an interactive
session.</p>
<p>There are very frequently tasks that need to be done interactively.
Creating an entire job script might be overkill, but the amount of
resources required is too much for a login node to handle. A good
example of this might be building a genome index for alignment with a
tool like <a href="https://daehwankimlab.github.io/hisat2/" class="external-link">HISAT2</a>.
Fortunately, we can run these types of tasks as a one-off with
<code>{{ site.sched.interactive }}</code>.</p>
<p><code>{{ site.sched.interactive }}</code> runs a single command on
the cluster and then exits. Let’s demonstrate this by running the
<code>hostname</code> command with
<code>{{ site.sched.interactive }}</code>. (We can cancel an
<code>{{ site.sched.interactive }}</code> job with
<code>Ctrl-c</code>.)</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.interactive }} hostname</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="op">{</span><span class="op">{</span> <span class="va">site.remote.node</span> <span class="op">}</span><span class="op">}</span></span></code></pre>
</div>
<p><code>{{ site.sched.interactive }}</code> accepts all of the same
options as <code>{{ site.sched.submit.name }}</code>. However, instead
of specifying these in a script, these options are specified on the
command-line when starting a job. To submit a job that uses 2 CPUs for
instance, we could use the following command:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.interactive }} <span class="at">-n</span> 2 echo <span class="st">"This job will use 2 CPUs."</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>This job will use 2 CPUs.
This job will use 2 CPUs.</code></pre>
</div>
<p>Typically, the resulting shell environment will be the same as that
for <code>{{ site.sched.submit.name }}</code>.</p>
<div class="section level3">
<h3 id="interactive-jobs">Interactive jobs<a class="anchor" aria-label="anchor" href="#interactive-jobs"></a>
</h3>
<p>Sometimes, you will need a lot of resources for interactive use.
Perhaps it’s our first time running an analysis or we are attempting to
debug something that went wrong with a previous job. Fortunately, {{
site.sched.name }} makes it easy to start an interactive job with
<code>{{ site.sched.interactive }}</code>:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.interactive }} <span class="at">--pty</span> bash</span></code></pre>
</div>
<p>You should be presented with a bash prompt. Note that the prompt will
likely change to reflect your new location, in this case the compute
node we are logged on. You can also verify this with
<code>hostname</code>.</p>
<div id="creating-remote-graphics" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="creating-remote-graphics" class="callout-inner">
<h3 class="callout-title">Creating remote graphics</h3>
<div class="callout-content">
<p>To see graphical output inside your jobs, you need to use X11
forwarding. To connect with this feature enabled, use the
<code>-Y</code> option when you login with the <code>ssh</code> command,
e.g.,
<code>ssh -Y {{ site.remote.user }}@{{ site.remote.login }}</code>.</p>
<p>To demonstrate what happens when you create a graphics window on the
remote node, use the <code>xeyes</code> command. A relatively adorable
pair of eyes should pop up (press <code>Ctrl-C</code> to stop). If you
are using a Mac, you must have installed XQuartz (and restarted your
computer) for this to work.</p>
<p>If your cluster has the <a href="https://github.com/hautreux/slurm-spank-x11" class="external-link">slurm-spank-x11</a>
plugin installed, you can ensure X11 forwarding within interactive jobs
by using the <code>--x11</code> option for
<code>{{ site.sched.interactive }}</code> with the command
<code>{{ site.sched.interactive }} --x11 --pty bash</code>.</p>
</div>
</div>
</div>
<p>When you are done with the interactive job, type <code>exit</code> to
quit your session.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>The scheduler handles how compute resources are shared between
users.</li>
<li>A job is just a shell script.</li>
<li>Request <em>slightly</em> more resources than you will need.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-14-environment-variables"><p>Content from <a href="14-environment-variables.html">Environment Variables</a></p>
<hr>
<p>Last updated on 2024-09-26 |

        <a href="https://github.com/tobyhodges/probable-pancake/edit/main/episodes/14-environment-variables.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How are variables set and accessed in the Unix shell?</li>
<li>How can I use variables to change how a program runs?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand how variables are implemented in the shell</li>
<li>Read the value of an existing variable</li>
<li>Create new variables and change their values</li>
<li>Change the behaviour of a program using an environment variable</li>
<li>Explain how the shell uses the <code>PATH</code> variable to search
for executables</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="episode-provenance" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="episode-provenance" class="callout-inner">
<h3 class="callout-title">Episode provenance</h3>
<div class="callout-content">
<p>This episode has been remixed from the <a href="https://github.com/carpentries-incubator/shell-extras/blob/gh-pages/_episodes/08-environment-variables.md" class="external-link">Shell
Extras episode on Shell Variables</a> and the <a href="https://github.com/hpc-carpentry/hpc-shell/blob/gh-pages/_episodes/05-scripts.md" class="external-link">HPC
Shell episode on scripts</a></p>
</div>
</div>
</div>
<p>The shell is just a program, and like other programs, it has
variables. Those variables control its execution, so by changing their
values you can change how the shell behaves (and with a little more
effort how other programs behave).</p>
<p>Variables are a great way of saving information under a name you can
access later. In programming languages like Python and R, variables can
store pretty much anything you can think of. In the shell, they usually
just store text. The best way to understand how they work is to see them
in action.</p>
<p>Let’s start by running the command <code>set</code> and looking at
some of the variables in a typical shell session:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="bu">set</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>COMPUTERNAME=TURING
HOME=/home/vlad
HOSTNAME=TURING
HOSTTYPE=i686
NUMBER_OF_PROCESSORS=4
PATH=/Users/vlad/bin:/usr/local/git/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin
PWD=/home/vlad
UID=1000
USERNAME=vlad
...</code></pre>
</div>
<p>As you can see, there are quite a few — in fact, four or five times
more than what’s shown here. And yes, using <code>set</code> to
<em>show</em> things might seem a little strange, even for Unix, but if
you don’t give it any arguments, it might as well show you things you
<em>could</em> set.</p>
<p>Every variable has a name. All shell variables’ values are strings,
even those (like <code>UID</code>) that look like numbers. It’s up to
programs to convert these strings to other types when necessary. For
example, if a program wanted to find out how many processors the
computer had, it would convert the value of the
<code>NUMBER_OF_PROCESSORS</code> variable from a string to an
integer.</p>
<section><h2 class="section-heading" id="showing-the-value-of-a-variable">Showing the Value of a Variable<a class="anchor" aria-label="anchor" href="#showing-the-value-of-a-variable"></a>
</h2>
<hr class="half-width">
<p>Let’s show the value of the variable <code>HOME</code>:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="bu">echo</span> HOME</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">HOME</span></span></code></pre>
</div>
<p>That just prints “HOME”, which isn’t what we wanted (though it is
what we actually asked for). Let’s try this instead:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$HOME</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/home/vlad</code></pre>
</div>
<p>The dollar sign tells the shell that we want the <em>value</em> of
the variable rather than its name. This works just like wildcards: the
shell does the replacement <em>before</em> running the program we’ve
asked for. Thanks to this expansion, what we actually run is
<code>echo /home/vlad</code>, which displays the right thing.</p>
</section><section><h2 class="section-heading" id="creating-and-changing-variables">Creating and Changing Variables<a class="anchor" aria-label="anchor" href="#creating-and-changing-variables"></a>
</h2>
<hr class="half-width">
<p>Creating a variable is easy — we just assign a value to a name using
“=” (we just have to remember that the syntax requires that there are
<em>no</em> spaces around the <code>=</code>!):</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="va">SECRET_IDENTITY</span><span class="op">=</span>Dracula</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$SECRET_IDENTITY</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">Dracula</span></span></code></pre>
</div>
<p>To change the value, just assign a new one:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="va">SECRET_IDENTITY</span><span class="op">=</span>Camilla</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$SECRET_IDENTITY</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">Camilla</span></span></code></pre>
</div>
</section><section><h2 class="section-heading" id="environment-variables">Environment variables<a class="anchor" aria-label="anchor" href="#environment-variables"></a>
</h2>
<hr class="half-width">
<p>When we ran the <code>set</code> command we saw there were a lot of
variables whose names were in upper case. That’s because, by convention,
variables that are also available to use by <em>other</em> programs are
given upper-case names. Such variables are called <em>environment
variables</em> as they are shell variables that are defined for the
current shell and are inherited by any child shells or processes.</p>
<p>To create an environment variable you need to <code>export</code> a
shell variable. For example, to make our <code>SECRET_IDENTITY</code>
available to other programs that we call from our shell we can do:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="va">SECRET_IDENTITY</span><span class="op">=</span>Camilla</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="bu">export</span> <span class="va">SECRET_IDENTITY</span></span></code></pre>
</div>
<p>You can also create and export the variable in a single step:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="bu">export</span> <span class="va">SECRET_IDENTITY</span><span class="op">=</span>Camilla</span></code></pre>
</div>
<div id="using-environment-variables-to-change-program-behaviour" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="using-environment-variables-to-change-program-behaviour" class="callout-inner">
<h3 class="callout-title">Using environment variables to change program behaviour</h3>
<div class="callout-content">
<p>Set a shell variable <code>TIME_STYLE</code> to have a value of
<code>iso</code> and check this value using the <code>echo</code>
command.</p>
<p>Now, run the command <code>ls</code> with the option <code>-l</code>
(which gives a long format).</p>
<p><code>export</code> the variable and rerun the <code>ls -l</code>
command. Do you notice any difference?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>The <code>TIME_STYLE</code> variable is not <em>seen</em> by
<code>ls</code> until is exported, at which point it is used by
<code>ls</code> to decide what date format to use when presenting the
timestamp of files.</p>
</div>
</div>
</div>
</div>
<p>You can see the complete set of environment variables in your current
shell session with the command <code>env</code> (which returns a subset
of what the command <code>set</code> gave us). <strong>The complete set
of environment variables is called your <em>runtime environment</em> and
can affect the behaviour of the programs you run</strong>.</p>
<div id="job-environment-variables" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="job-environment-variables" class="callout-inner">
<h3 class="callout-title">Job environment variables</h3>
<div class="callout-content">
<p>When {{ site.sched.name }} runs a job, it sets a number of
environment variables for the job. One of these will let us check what
directory our job script was submitted from. The
<code>SLURM_SUBMIT_DIR</code> variable is set to the directory from
which our job was submitted. Using the <code>SLURM_SUBMIT_DIR</code>
variable, modify your job so that it prints out the location from which
the job was submitted.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} nano example-job.sh</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} cat example-job.sh</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{{ site.remote.bash_shebang }}
#SBATCH -t 00:00:30

echo -n "This script is running on "
hostname

echo "This job was launched in the following directory:"
echo ${SLURM_SUBMIT_DIR}</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>To remove a variable or environment variable you can use the
<code>unset</code> command, for example:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="bu">unset</span> <span class="va">SECRET_IDENTITY</span></span></code></pre>
</div>
</section><section><h2 class="section-heading" id="the-path-environment-variable">The <code>PATH</code> Environment Variable<a class="anchor" aria-label="anchor" href="#the-path-environment-variable"></a>
</h2>
<hr class="half-width">
<p>Similarly, some environment variables (like <code>PATH</code>) store
lists of values. In this case, the convention is to use a colon ‘:’ as a
separator. If a program wants the individual elements of such a list,
it’s the program’s responsibility to split the variable’s string value
into pieces.</p>
<p>Let’s have a closer look at that <code>PATH</code> variable. Its
value defines the shell’s search path for executables, i.e., the list of
directories that the shell looks in for runnable programs when you type
in a program name without specifying what directory it is in.</p>
<p>For example, when we type a command like <code>analyze</code>, the
shell needs to decide whether to run <code>./analyze</code> or
<code>/bin/analyze</code>. The rule it uses is simple: the shell checks
each directory in the <code>PATH</code> variable in turn, looking for a
program with the requested name in that directory. As soon as it finds a
match, it stops searching and runs the program.</p>
<p>To show how this works, here are the components of <code>PATH</code>
listed one per line:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/Users/vlad/bin
/usr/local/git/bin
/usr/bin
/bin
/usr/sbin
/sbin
/usr/local/bin</code></pre>
</div>
<p>On our computer, there are actually three programs called
<code>analyze</code> in three different directories:
<code>/bin/analyze</code>, <code>/usr/local/bin/analyze</code>, and
<code>/users/vlad/analyze</code>. Since the shell searches the
directories in the order they’re listed in <code>PATH</code>, it finds
<code>/bin/analyze</code> first and runs that. Notice that it will
<em>never</em> find the program <code>/users/vlad/analyze</code> unless
we type in the full path to the program, since the directory
<code>/users/vlad</code> isn’t in <code>PATH</code>.</p>
<p>This means that I can have executables in lots of different places as
long as I remember that I need to to update my <code>PATH</code> so that
my shell can find them.</p>
<p>What if I want to run two different versions of the same program?
Since they share the same name, if I add them both to my
<code>PATH</code> the first one found will always win. In the next
episode we’ll learn how to use helper tools to help us manage our
runtime environment to make that possible without us needing to do a lot
of bookkeeping on what the value of <code>PATH</code> (and other
important environment variables) is or should be.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Shell variables are by default treated as strings</li>
<li>Variables are assigned using “<code>=</code>” and recalled using the
variable’s name prefixed by “<code>$</code>”</li>
<li>Use “<code>export</code>” to make an variable available to other
programs</li>
<li>The <code>PATH</code> variable defines the shell’s search path</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-15-modules"><p>Content from <a href="15-modules.html">Accessing software via Modules</a></p>
<hr>
<p>Last updated on 2024-09-26 |

        <a href="https://github.com/tobyhodges/probable-pancake/edit/main/episodes/15-modules.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we load and unload software packages?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Load and use a software package.</li>
<li>Explain how the shell environment changes when the module mechanism
loads or unloads packages.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>On a high-performance computing system, it is seldom the case that
the software we want to use is available when we log in. It is
installed, but we will need to “load” it before it can run.</p>
<p>Before we start using individual software packages, however, we
should understand the reasoning behind this approach. The three biggest
factors are:</p>
<ul>
<li>software incompatibilities</li>
<li>versioning</li>
<li>dependencies</li>
</ul>
<p>Software incompatibility is a major headache for programmers.
Sometimes the presence (or absence) of a software package will break
others that depend on it. Two well known examples are Python and C
compiler versions. Python 3 famously provides a <code>python</code>
command that conflicts with that provided by Python 2. Software compiled
against a newer version of the C libraries and then run on a machine
that has older C libraries installed will result in a nasty
<code>'GLIBCXX_3.4.20' not found</code> error.</p>
<p>Software versioning is another common issue. A team might depend on a
certain package version for their research project - if the software
version was to change (for instance, if a package was updated), it might
affect their results. Having access to multiple software versions allows
a set of researchers to prevent software versioning issues from
affecting their results.</p>
<p>Dependencies are where a particular software package (or even a
particular version) depends on having access to another software package
(or even a particular version of another software package). For example,
the VASP materials science software may depend on having a particular
version of the FFTW (Fastest Fourier Transform in the West) software
library available for it to work.</p>
<section><h2 class="section-heading" id="environment-modules">Environment Modules<a class="anchor" aria-label="anchor" href="#environment-modules"></a>
</h2>
<hr class="half-width">
<p>Environment modules are the solution to these problems. A
<em>module</em> is a self-contained description of a software package –
it contains the settings required to run a software package and,
usually, encodes required dependencies on other software packages.</p>
<p>There are a number of different environment module implementations
commonly used on HPC systems: the two most common are <em>TCL
modules</em> and <em>Lmod</em>. Both of these use similar syntax and the
concepts are the same so learning to use one will allow you to use
whichever is installed on the system you are using. In both
implementations the <code>module</code> command is used to interact with
environment modules. An additional subcommand is usually added to the
command to specify what you want to do. For a list of subcommands you
can use <code>module -h</code> or <code>module help</code>. As for all
commands, you can access the full help on the <em>man</em> pages with
<code>man module</code>.</p>
<p>On login you may start out with a default set of modules loaded or
you may start out with an empty environment; this depends on the setup
of the system you are using.</p>
<div class="section level3">
<h3 id="listing-available-modules">Listing Available Modules<a class="anchor" aria-label="anchor" href="#listing-available-modules"></a>
</h3>
<p>To see available software modules, use <code>module avail</code>:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} module avail</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>~~~ /cvmfs/pilot.eessi-hpc.org/2020.12/software/x86_64/amd/zen2/modules/all ~~~
  Bazel/3.6.0-GCCcore-x.y.z              NSS/3.51-GCCcore-x.y.z
  Bison/3.5.3-GCCcore-x.y.z              Ninja/1.10.0-GCCcore-x.y.z
  Boost/1.72.0-gompi-2020a               OSU-Micro-Benchmarks/5.6.3-gompi-2020a
  CGAL/4.14.3-gompi-2020a-Python-3.x.y   OpenBLAS/0.3.9-GCC-x.y.z
  CMake/3.16.4-GCCcore-x.y.z             OpenFOAM/v2006-foss-2020a

[removed most of the output here for clarity]

  Where:
   L:        Module is loaded
   Aliases:  Aliases exist: foo/1.2.3 (1.2) means that "module load foo/1.2"
             will load foo/1.2.3
   D:        Default Module

Use "module spider" to find all possible modules and extensions.
Use "module keyword key1 key2 ..." to search for all possible modules matching
any of the "keys".</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="listing-currently-loaded-modules">Listing Currently Loaded Modules<a class="anchor" aria-label="anchor" href="#listing-currently-loaded-modules"></a>
</h3>
<p>You can use the <code>module list</code> command to see which modules
you currently have loaded in your environment. If you have no modules
loaded, you will see a message telling you so</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} module list</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>No Modulefiles Currently Loaded.</code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="loading-and-unloading-software">Loading and Unloading Software<a class="anchor" aria-label="anchor" href="#loading-and-unloading-software"></a>
</h2>
<hr class="half-width">
<p>To load a software module, use <code>module load</code>. In this
example we will use Python 3.</p>
<p>Initially, Python 3 is not loaded. We can test this by using the
<code>which</code> command. <code>which</code> looks for programs the
same way that Bash does, so we can use it to tell us where a particular
piece of software is stored.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} which python3</span></code></pre>
</div>
<p>If the <code>python3</code> command was unavailable, we would see
output like</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/usr/bin/which: no python3 in (/cvmfs/pilot.eessi-hpc.org/2020.12/compat/linux/x86_64/usr/bin:/opt/software/slurm/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/opt/puppetlabs/bin:/home/{{site.remote.user}}/.local/bin:/home/{{site.remote.user}}/bin)</code></pre>
</div>
<p>Note that this wall of text is really a list, with values separated
by the <code>:</code> character. The output is telling us that the
<code>which</code> command searched the following directories for
<code>python3</code>, without success:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/cvmfs/pilot.eessi-hpc.org/2020.12/compat/linux/x86_64/usr/bin
/opt/software/slurm/bin
/usr/local/bin
/usr/bin
/usr/local/sbin
/usr/sbin
/opt/puppetlabs/bin
/home/{{site.remote.user}}/.local/bin
/home/{{site.remote.user}}/bin</code></pre>
</div>
<p>However, in our case we do have an existing <code>python3</code>
available so we see</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/cvmfs/pilot.eessi-hpc.org/2020.12/compat/linux/x86_64/usr/bin/python3</code></pre>
</div>
<p>We need a different Python than the system provided one though, so
let us load a module to access it.</p>
<p>We can load the <code>python3</code> command with
<code>module load</code>:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} module load {{ site.remote.module_python3 }}</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} which python3</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/cvmfs/pilot.eessi-hpc.org/2020.12/software/x86_64/amd/zen2/software/Python/3.x.y-GCCcore-x.y.z/bin/python3</code></pre>
</div>
<p>So, what just happened?</p>
<p>To understand the output, first we need to understand the nature of
the <code>$PATH</code> environment variable. <code>$PATH</code> is a
special environment variable that controls where a UNIX system looks for
software. Specifically <code>$PATH</code> is a list of directories
(separated by <code>:</code>) that the OS searches through for a command
before giving up and telling us it can’t find it. As with all
environment variables we can print it out using <code>echo</code>.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} echo <span class="va">$PATH</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/cvmfs/pilot.eessi-hpc.org/2020.12/software/x86_64/amd/zen2/software/Python/3.x.y-GCCcore-x.y.z/bin:/cvmfs/pilot.eessi-hpc.org/2020.12/software/x86_64/amd/zen2/software/SQLite/3.31.1-GCCcore-x.y.z/bin:/cvmfs/pilot.eessi-hpc.org/2020.12/software/x86_64/amd/zen2/software/Tcl/8.6.10-GCCcore-x.y.z/bin:/cvmfs/pilot.eessi-hpc.org/2020.12/software/x86_64/amd/zen2/software/GCCcore/x.y.z/bin:/cvmfs/pilot.eessi-hpc.org/2020.12/compat/linux/x86_64/usr/bin:/opt/software/slurm/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/opt/puppetlabs/bin:/home/user01/.local/bin:/home/user01/bin</code></pre>
</div>
<p>You’ll notice a similarity to the output of the <code>which</code>
command. In this case, there’s only one difference: the different
directory at the beginning. When we ran the <code>module load</code>
command, it added a directory to the beginning of our
<code>$PATH</code>. Let’s examine what’s there:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} ls /cvmfs/pilot.eessi-hpc.org/2020.12/software/x86_64/amd/zen2/software/Python/3.x.y-GCCcore-x.y.z/bin</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>2to3              nosetests-3.8  python                 rst2s5.py
2to3-3.8          pasteurize     python3                rst2xetex.py
chardetect        pbr            python3.8              rst2xml.py
cygdb             pip            python3.8-config       rstpep2html.py
cython            pip3           python3-config         runxlrd.py
cythonize         pip3.8         rst2html4.py           sphinx-apidoc
easy_install      pybabel        rst2html5.py           sphinx-autogen
easy_install-3.8  __pycache__    rst2html.py            sphinx-build
futurize          pydoc3         rst2latex.py           sphinx-quickstart
idle3             pydoc3.8       rst2man.py             tabulate
idle3.8           pygmentize     rst2odt_prepstyles.py  virtualenv
netaddr           pytest         rst2odt.py             wheel
nosetests         py.test        rst2pseudoxml.py</code></pre>
</div>
<p>Taking this to its conclusion, <code>module load</code> will add
software to your <code>$PATH</code>. It “loads” software. A special note
on this - depending on which version of the <code>module</code> program
that is installed at your site, <code>module load</code> will also load
required software dependencies.</p>
<p>To demonstrate, let’s use <code>module list</code>.
<code>module list</code> shows all loaded software modules.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} module list</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Currently Loaded Modules:
  1) GCCcore/x.y.z                 4) GMP/6.2.0-GCCcore-x.y.z
  2) Tcl/8.6.10-GCCcore-x.y.z      5) libffi/3.3-GCCcore-x.y.z
  3) SQLite/3.31.1-GCCcore-x.y.z   6) Python/3.x.y-GCCcore-x.y.z</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} module load GROMACS</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} module list</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Currently Loaded Modules:
  1) GCCcore/x.y.z                    14) libfabric/1.11.0-GCCcore-x.y.z
  2) Tcl/8.6.10-GCCcore-x.y.z         15) PMIx/3.1.5-GCCcore-x.y.z
  3) SQLite/3.31.1-GCCcore-x.y.z      16) OpenMPI/4.0.3-GCC-x.y.z
  4) GMP/6.2.0-GCCcore-x.y.z          17) OpenBLAS/0.3.9-GCC-x.y.z
  5) libffi/3.3-GCCcore-x.y.z         18) gompi/2020a
  6) Python/3.x.y-GCCcore-x.y.z       19) FFTW/3.3.8-gompi-2020a
  7) GCC/x.y.z                        20) ScaLAPACK/2.1.0-gompi-2020a
  8) numactl/2.0.13-GCCcore-x.y.z     21) foss/2020a
  9) libxml2/2.9.10-GCCcore-x.y.z     22) pybind11/2.4.3-GCCcore-x.y.z-Pytho...
 10) libpciaccess/0.16-GCCcore-x.y.z  23) SciPy-bundle/2020.03-foss-2020a-Py...
 11) hwloc/2.2.0-GCCcore-x.y.z        24) networkx/2.4-foss-2020a-Python-3.8...
 12) libevent/2.1.11-GCCcore-x.y.z    25) GROMACS/2020.1-foss-2020a-Python-3...
 13) UCX/1.8.0-GCCcore-x.y.z</code></pre>
</div>
<p>So in this case, loading the <code>GROMACS</code> module (a
bioinformatics software package), also loaded
<code>GMP/6.2.0-GCCcore-x.y.z</code> and
<code>SciPy-bundle/2020.03-foss-2020a-Python-3.x.y</code> as well. Let’s
try unloading the <code>GROMACS</code> package.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} module unload GROMACS</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} module list</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Currently Loaded Modules:
  1) GCCcore/x.y.z                    13) UCX/1.8.0-GCCcore-x.y.z
  2) Tcl/8.6.10-GCCcore-x.y.z         14) libfabric/1.11.0-GCCcore-x.y.z
  3) SQLite/3.31.1-GCCcore-x.y.z      15) PMIx/3.1.5-GCCcore-x.y.z
  4) GMP/6.2.0-GCCcore-x.y.z          16) OpenMPI/4.0.3-GCC-x.y.z
  5) libffi/3.3-GCCcore-x.y.z         17) OpenBLAS/0.3.9-GCC-x.y.z
  6) Python/3.x.y-GCCcore-x.y.z       18) gompi/2020a
  7) GCC/x.y.z                        19) FFTW/3.3.8-gompi-2020a
  8) numactl/2.0.13-GCCcore-x.y.z     20) ScaLAPACK/2.1.0-gompi-2020a
  9) libxml2/2.9.10-GCCcore-x.y.z     21) foss/2020a
 10) libpciaccess/0.16-GCCcore-x.y.z  22) pybind11/2.4.3-GCCcore-x.y.z-Pytho...
 11) hwloc/2.2.0-GCCcore-x.y.z        23) SciPy-bundle/2020.03-foss-2020a-Py...
 12) libevent/2.1.11-GCCcore-x.y.z    24) networkx/2.4-foss-2020a-Python-3.x.y</code></pre>
</div>
<p>So using <code>module unload</code> “un-loads” a module, and
depending on how a site is configured it may also unload all of the
dependencies (in our case it does not). If we wanted to unload
everything at once, we could run <code>module purge</code> (unloads
everything).</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} module purge</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} module list</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>No modules loaded</code></pre>
</div>
<p>Note that <code>module purge</code> is informative. It will also let
us know if a default set of “sticky” packages cannot be unloaded (and
how to actually unload these if we truly so desired).</p>
<p>Note that this module loading process happens principally through the
manipulation of environment variables like <code>$PATH</code>. There is
usually little or no data transfer involved.</p>
<p>The module loading process manipulates other special environment
variables as well, including variables that influence where the system
looks for software libraries, and sometimes variables which tell
commercial software packages where to find license servers.</p>
<p>The module command also restores these shell environment variables to
their previous state when a module is unloaded.</p>
</section><section><h2 class="section-heading" id="software-versioning">Software Versioning<a class="anchor" aria-label="anchor" href="#software-versioning"></a>
</h2>
<hr class="half-width">
<p>So far, we’ve learned how to load and unload software packages. This
is very useful. However, we have not yet addressed the issue of software
versioning. At some point or other, you will run into issues where only
one particular version of some software will be suitable. Perhaps a key
bugfix only happened in a certain version, or version X broke
compatibility with a file format you use. In either of these example
cases, it helps to be very specific about what software is loaded.</p>
<p>Let’s examine the output of <code>module avail</code> more
closely.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} module avail</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>~~~ /cvmfs/pilot.eessi-hpc.org/2020.12/software/x86_64/amd/zen2/modules/all ~~~
  Bazel/3.6.0-GCCcore-x.y.z              NSS/3.51-GCCcore-x.y.z
  Bison/3.5.3-GCCcore-x.y.z              Ninja/1.10.0-GCCcore-x.y.z
  Boost/1.72.0-gompi-2020a               OSU-Micro-Benchmarks/5.6.3-gompi-2020a
  CGAL/4.14.3-gompi-2020a-Python-3.x.y   OpenBLAS/0.3.9-GCC-x.y.z
  CMake/3.16.4-GCCcore-x.y.z             OpenFOAM/v2006-foss-2020a

[removed most of the output here for clarity]

  Where:
   L:        Module is loaded
   Aliases:  Aliases exist: foo/1.2.3 (1.2) means that "module load foo/1.2"
             will load foo/1.2.3
   D:        Default Module

Use "module spider" to find all possible modules and extensions.
Use "module keyword key1 key2 ..." to search for all possible modules matching
any of the "keys".</code></pre>
</div>
<div id="using-software-modules-in-scripts" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="using-software-modules-in-scripts" class="callout-inner">
<h3 class="callout-title">Using Software Modules in Scripts</h3>
<div class="callout-content">
<p>Create a job that is able to run <code>python3 --version</code>.
Remember, no software is loaded by default! Running a job is just like
logging on to the system (you should not assume a module loaded on the
login node is loaded on a compute node).</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} nano python-module.sh</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} cat python-module.sh</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{{ site.remote.bash_shebang }}
{{ site.sched.comment }} {{ site.sched.flag.partition }}{% if site.sched.flag.qos %}
{{ site.sched.comment }} {{ site.sched.flag.qos }}
{% endif %}{{ site.sched.comment }} {{ site.sched.flag.time }} 00:00:30

module load {{ site.remote.module_python3 }}

python3 --version</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.submit.name }} {% if site.sched.submit.options != <span class="st">''</span> %}{{ site.sched.submit.options }} {% endif %}python-module.sh</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Load software with <code>module load softwareName</code>.</li>
<li>Unload software with <code>module unload</code>
</li>
<li>The module system handles software versioning and package conflicts
for you automatically.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-16-transferring-files"><p>Content from <a href="16-transferring-files.html">Transferring files with remote computers</a></p>
<hr>
<p>Last updated on 2024-09-26 |

        <a href="https://github.com/tobyhodges/probable-pancake/edit/main/episodes/16-transferring-files.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I transfer files to (and from) the cluster?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Transfer files to and from a computing cluster.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Performing work on a remote computer is not very useful if we cannot
get files to or from the cluster. There are several options for
transferring data between computing resources using CLI and GUI
utilities, a few of which we will cover.</p>
<section><h2 class="section-heading" id="download-lesson-files-from-the-internet">Download Lesson Files From the Internet<a class="anchor" aria-label="anchor" href="#download-lesson-files-from-the-internet"></a>
</h2>
<hr class="half-width">
<p>One of the most straightforward ways to download files is to use
either <code>curl</code> or <code>wget</code>. One of these is usually
installed in most Linux shells, on Mac OS terminal and in GitBash. Any
file that can be downloaded in your web browser through a direct link
can be downloaded using <code>curl</code> or <code>wget</code>. This is
a quick way to download datasets or source code. The syntax for these
commands is</p>
<ul>
<li><code>wget [-O new_name] https://some/link/to/a/file</code></li>
<li><code>curl [-o new_name] https://some/link/to/a/file</code></li>
</ul>
<p>Try it out by downloading some material we’ll use later on, from a
terminal on your local machine, using the URL of the current
codebase:</p>
<p><a href="https://github.com/hpc-carpentry/amdahl/tarball/main" class="external-link uri">https://github.com/hpc-carpentry/amdahl/tarball/main</a></p>
<div id="download-the-tarball" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="download-the-tarball" class="callout-inner">
<h3 class="callout-title">Download the “Tarball”</h3>
<div class="callout-content">
<p>The word “tarball” in the above URL refers to a compressed archive
format commonly used on Linux, which is the operating system the
majority of HPC cluster machines run. A tarball is a lot like a
<code>.zip</code> file. The actual file extension is
<code>.tar.gz</code>, which reflects the two-stage process used to
create the file: the files or folders are merged into a single file
using <code>tar</code>, which is then compressed using
<code>gzip</code>, so the file extension is “tar-dot-g-z.” That’s a
mouthful, so people often say “the <em>xyz</em> tarball” instead.</p>
<p>You may also see the extension <code>.tgz</code>, which is just an
abbreviation of <code>.tar.gz</code>.</p>
<p>By default, <code>curl</code> and <code>wget</code> download files to
the same name as the URL: in this case, <code>main</code>. Use one of
the above commands to save the tarball as
<code>amdahl.tar.gz</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> wget and curl Commands </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} wget <span class="at">-O</span> amdahl.tar.gz https://github.com/hpc-carpentry/amdahl/tarball/main</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} curl <span class="at">-o</span> amdahl.tar.gz <span class="at">-L</span> https://github.com/hpc-carpentry/amdahl/tarball/main</span></code></pre>
</div>
<p>The <code>-L</code> option to <code>curl</code> tells it to follow
URL redirects (which <code>wget</code> does by default).</p>
</div>
</div>
</div>
</div>
<p>After downloading the file, use <code>ls</code> to see it in your
working directory:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} ls</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="archiving-files">Archiving Files<a class="anchor" aria-label="anchor" href="#archiving-files"></a>
</h2>
<hr class="half-width">
<p>One of the biggest challenges we often face when transferring data
between remote HPC systems is that of large numbers of files. There is
an overhead to transferring each individual file and when we are
transferring large numbers of files these overheads combine to slow down
our transfers to a large degree.</p>
<p>The solution to this problem is to <em>archive</em> multiple files
into smaller numbers of larger files before we transfer the data to
improve our transfer efficiency. Sometimes we will combine archiving
with <em>compression</em> to reduce the amount of data we have to
transfer and so speed up the transfer. The most common archiving command
you will use on a (Linux) HPC cluster is <code>tar</code>.</p>
<p><code>tar</code> can be used to combine files and folders into a
single archive file and, optionally, compress the result. Let’s look at
the file we downloaded from the lesson site,
<code>amdahl.tar.gz</code>.</p>
<p>The <code>.gz</code> part stands for <em>gzip</em>, which is a
compression library. It’s common (but not necessary!) that this kind of
file can be interpreted by reading its name: it appears somebody took
files and folders relating to something called “amdahl,” wrapped them
all up into a single file with <code>tar</code>, then compressed that
archive with <code>gzip</code> to save space.</p>
<p>Let’s see if that is the case, <em>without</em> unpacking the file.
<code>tar</code> prints the “<strong>t</strong>able of contents” with
the <code>-t</code> flag, for the file specified with the
<code>-f</code> flag followed by the filename. Note that you can
concatenate the two flags: writing <code>-t -f</code> is interchangeable
with writing <code>-tf</code> together. However, the argument following
<code>-f</code> must be a filename, so writing <code>-ft</code> will
<em>not</em> work.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} tar <span class="at">-tf</span> amdahl.tar.gz</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/.github/</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/.github/workflows/</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/.github/workflows/python-publish.yml</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/.gitignore</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/LICENSE</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/README.md</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/amdahl/</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/amdahl/__init__.py</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/amdahl/__main__.py</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/amdahl/amdahl.py</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/requirements.txt</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="ex">hpc-carpentry-amdahl-46c9b4b/setup.py</span></span></code></pre>
</div>
<p>This example output shows a folder which contains a few files, where
<code>46c9b4b</code> is an 8-character <a href="https://swcarpentry.github.io/git-novice/" class="external-link">git</a> commit hash
that will change when the source material is updated.</p>
<p>Now let’s unpack the archive. We’ll run <code>tar</code> with a few
common flags:</p>
<ul>
<li>
<code>-x</code> to e<strong>x</strong>tract the archive</li>
<li>
<code>-v</code> for <strong>v</strong>erbose output</li>
<li>
<code>-z</code> for g<strong>z</strong>ip compression</li>
<li>
<code>-f «tarball»</code> for the file to be unpacked</li>
</ul>
<div id="extract-the-archive" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="extract-the-archive" class="callout-inner">
<h3 class="callout-title">Extract the Archive</h3>
<div class="callout-content">
<p>Using the flags above, unpack the source code tarball into a new
directory named “amdahl” using <code>tar</code>.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} tar <span class="at">-xvzf</span> amdahl.tar.gz</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>hpc-carpentry-amdahl-46c9b4b/
hpc-carpentry-amdahl-46c9b4b/.github/
hpc-carpentry-amdahl-46c9b4b/.github/workflows/
hpc-carpentry-amdahl-46c9b4b/.github/workflows/python-publish.yml
hpc-carpentry-amdahl-46c9b4b/.gitignore
hpc-carpentry-amdahl-46c9b4b/LICENSE
hpc-carpentry-amdahl-46c9b4b/README.md
hpc-carpentry-amdahl-46c9b4b/amdahl/
hpc-carpentry-amdahl-46c9b4b/amdahl/__init__.py
hpc-carpentry-amdahl-46c9b4b/amdahl/__main__.py
hpc-carpentry-amdahl-46c9b4b/amdahl/amdahl.py
hpc-carpentry-amdahl-46c9b4b/requirements.txt
hpc-carpentry-amdahl-46c9b4b/setup.py</code></pre>
</div>
<p>Note that we did not need to type out <code>-x -v -z -f</code>,
thanks to flag concatenation, though the command works identically
either way – so long as the concatenated list ends with <code>f</code>,
because the next string must specify the name of the file to
extract.</p>
</div>
</div>
</div>
<p>The folder has an unfortunate name, so let’s change that to something
more convenient.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} mv hpc-carpentry-amdahl-46c9b4b amdahl</span></code></pre>
</div>
<p>Check the size of the extracted directory and compare to the
compressed file size, using <code>du</code> for “<strong>d</strong>isk
<strong>u</strong>sage”.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} du <span class="at">-sh</span> amdahl.tar.gz</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="ex">8.0K</span>     amdahl.tar.gz</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} du <span class="at">-sh</span> amdahl</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="ex">48K</span>    amdahl</span></code></pre>
</div>
<p>Text files (including Python source code) compress nicely: the
“tarball” is one-sixth the total size of the raw data!</p>
<p>If you want to reverse the process – compressing raw data instead of
extracting it – set a <code>c</code> flag instead of <code>x</code>, set
the archive filename, then provide a directory to compress:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} tar <span class="at">-cvzf</span> compressed_code.tar.gz amdahl</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>amdahl/
amdahl/.github/
amdahl/.github/workflows/
amdahl/.github/workflows/python-publish.yml
amdahl/.gitignore
amdahl/LICENSE
amdahl/README.md
amdahl/amdahl/
amdahl/amdahl/__init__.py
amdahl/amdahl/__main__.py
amdahl/amdahl/amdahl.py
amdahl/requirements.txt
amdahl/setup.py</code></pre>
</div>
<p>If you give <code>amdahl.tar.gz</code> as the filename in the above
command, <code>tar</code> will update the existing tarball with any
changes you made to the files. That would mean adding the new
<code>amdahl</code> folder to the <em>existing</em> folder
(<code>hpc-carpentry-amdahl-46c9b4b</code>) inside the tarball, doubling
the size of the archive!</p>
<div id="working-with-windows" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="working-with-windows" class="callout-inner">
<h3 class="callout-title">Working with Windows</h3>
<div class="callout-content">
<p>When you transfer text files from a Windows system to a Unix system
(Mac, Linux, BSD, Solaris, etc.) this can cause problems. Windows
encodes its files slightly different than Unix, and adds an extra
character to every line.</p>
<p>On a Unix system, every line in a file ends with a <code>\n</code>
(newline). On Windows, every line in a file ends with a
<code>\r\n</code> (carriage return + newline). This causes problems
sometimes.</p>
<p>Though most modern programming languages and software handles this
correctly, in some rare instances, you may run into an issue. The
solution is to convert a file from Windows to Unix encoding with the
<code>dos2unix</code> command.</p>
<p>You can identify if a file has Windows line endings with
<code>cat -A filename</code>. A file with Windows line endings will have
<code>^M$</code> at the end of every line. A file with Unix line endings
will have <code>$</code> at the end of a line.</p>
<p>To convert the file, just run <code>dos2unix filename</code>.
(Conversely, to convert back to Windows format, you can run
<code>unix2dos filename</code>.)</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="transferring-single-files-and-folders-with-scp">Transferring Single Files and Folders With <code>scp</code>
<a class="anchor" aria-label="anchor" href="#transferring-single-files-and-folders-with-scp"></a>
</h2>
<hr class="half-width">
<p>To copy a single file to or from the cluster, we can use
<code>scp</code> (“secure copy”). The syntax can be a little complex for
new users, but we’ll break it down. The <code>scp</code> command is a
relative of the <code>ssh</code> command we used to access the system,
and can use the same public-key authentication mechanism.</p>
<p>To <em>upload to</em> another computer, the template command is</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} scp local_file {{ site.remote.user }}@{{ site.remote.login }}:remote_destination</span></code></pre>
</div>
<p>in which <code>@</code> and <code>:</code> are field separators and
<code>remote_destination</code> is a path relative to your remote home
directory, or a new filename if you wish to change it, or both a
relative path <em>and</em> a new filename. If you don’t have a specific
folder in mind you can omit the <code>remote_destination</code> and the
file will be copied to your home directory on the remote computer (with
its original name). If you include a <code>remote_destination</code>,
note that <code>scp</code> interprets this the same way <code>cp</code>
does when making local copies: if it exists and is a folder, the file is
copied inside the folder; if it exists and is a file, the file is
overwritten with the contents of <code>local_file</code>; if it does not
exist, it is assumed to be a destination filename for
<code>local_file</code>.</p>
<p>Upload the lesson material to your remote home directory like so:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} scp amdahl.tar.gz {{ site.remote.user }}@{{ site.remote.login }}:</span></code></pre>
</div>
<div id="why-not-download-on-site.remote.name-directly" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="why-not-download-on-site.remote.name-directly" class="callout-inner">
<h3 class="callout-title">Why Not Download on {{ site.remote.name }} Directly?</h3>
<div class="callout-content">
<p>Most computer clusters are protected from the open internet by a
<em>firewall</em>. For enhanced security, some are configured to allow
traffic <em>inbound</em>, but not <em>outbound</em>. This means that an
authenticated user can send a file to a cluster machine, but a cluster
machine cannot retrieve files from a user’s machine or the open
Internet.</p>
<p>Try downloading the file directly. Note that it may well fail, and
that’s OK!</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Commands </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} ssh {{ site.remote.user }}@{{ site.remote.login }}</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} wget <span class="at">-O</span> amdahl.tar.gz https://github.com/hpc-carpentry/amdahl/tarball/main</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} curl <span class="at">-o</span> amdahl.tar.gz https://github.com/hpc-carpentry/amdahl/tarball/main</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="why-not-download-on-site.remote.name-directly" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="why-not-download-on-site.remote.name-directly" class="callout-inner">
<h3 class="callout-title">Why Not Download on {{ site.remote.name }}
Directly?<em> (continued)</em>
</h3>
<div class="callout-content">
<p>Did it work? If not, what does the terminal output tell you about
what happened?</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="transferring-a-directory">Transferring a Directory<a class="anchor" aria-label="anchor" href="#transferring-a-directory"></a>
</h2>
<hr class="half-width">
<p>To transfer an entire directory, we add the <code>-r</code> flag for
“<strong>r</strong>ecursive”: copy the item specified, and every item
below it, and every item below those… until it reaches the bottom of the
directory tree rooted at the folder name you provided.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} scp <span class="at">-r</span> amdahl {{ site.remote.user }}@{{ site.remote.login }}:</span></code></pre>
</div>
<div id="caution" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="caution" class="callout-inner">
<h3 class="callout-title">Caution</h3>
<div class="callout-content">
<p>For a large directory – either in size or number of files – copying
with <code>-r</code> can take a long time to complete.</p>
</div>
</div>
</div>
<p>When using <code>scp</code>, you may have noticed that a
<code>:</code> <em>always</em> follows the remote computer name. A
string <em>after</em> the <code>:</code> specifies the remote directory
you wish to transfer the file or folder to, including a new name if you
wish to rename the remote material. If you leave this field blank,
<code>scp</code> defaults to your home directory and the name of the
local material to be transferred.</p>
<p>On Linux computers, <code>/</code> is the separator in file or
directory paths. A path starting with a <code>/</code> is called
<em>absolute</em>, since there can be nothing above the root
<code>/</code>. A path that does not start with <code>/</code> is called
<em>relative</em>, since it is not anchored to the root.</p>
<p>If you want to upload a file to a location inside your home directory
– which is often the case – then you don’t need a <em>leading</em>
<code>/</code>. After the <code>:</code>, you can type the destination
path relative to your home directory. If your home directory <em>is</em>
the destination, you can leave the destination field blank, or type
<code>~</code> – the shorthand for your home directory – for
completeness.</p>
<p>With <code>scp</code>, a trailing slash on the target directory is
optional, and has no effect. A trailing slash on a source directory is
important for other commands, like <code>rsync</code>.</p>
<div id="a-note-on-rsync" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="a-note-on-rsync" class="callout-inner">
<h3 class="callout-title">A Note on <code>rsync</code>
</h3>
<div class="callout-content">
<p>As you gain experience with transferring files, you may find the
<code>scp</code> command limiting. The <a href="https://rsync.samba.org/" class="external-link">rsync</a> utility provides advanced
features for file transfer and is typically faster compared to both
<code>scp</code> and <code>sftp</code> (see below). It is especially
useful for transferring large and/or many files and for synchronizing
folder contents between computers.</p>
<p>The syntax is similar to <code>scp</code>. To transfer <em>to</em>
another computer with commonly used options:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} rsync <span class="at">-avP</span> amdahl.tar.gz {{ site.remote.user }}@{{ site.remote.login }}:</span></code></pre>
</div>
<p>The options are:</p>
<ul>
<li>
<code>-a</code> (<strong>a</strong>rchive) to preserve file
timestamps, permissions, and folders, among other things; implies
recursion</li>
<li>
<code>-v</code> (<strong>v</strong>erbose) to get verbose output to
help monitor the transfer</li>
<li>
<code>-P</code> (partial/progress) to preserve partially transferred
files in case of an interruption and also displays the progress of the
transfer.</li>
</ul>
<p>To recursively copy a directory, we can use the same options:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} rsync <span class="at">-avP</span> amdahl {{ site.remote.user }}@{{ site.remote.login }}:~/</span></code></pre>
</div>
<p>As written, this will place the local directory and its contents
under your home directory on the remote system. If a trailing slash is
added to the source, a new directory corresponding to the transferred
directory will not be created, and the contents of the source directory
will be copied directly into the destination directory.</p>
<p>To download a file, we simply change the source and destination:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} rsync <span class="at">-avP</span> {{ site.remote.user }}@{{ site.remote.login }}:amdahl ./</span></code></pre>
</div>
</div>
</div>
</div>
<p>File transfers using both <code>scp</code> and <code>rsync</code> use
SSH to encrypt data sent through the network. So, if you can connect via
SSH, you will be able to transfer files. By default, SSH uses network
port 22. If a custom SSH port is in use, you will have to specify it
using the appropriate flag, often <code>-p</code>, <code>-P</code>, or
<code>--port</code>. Check <code>--help</code> or the <code>man</code>
page if you’re unsure.</p>
<div id="change-the-rsync-port" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="change-the-rsync-port" class="callout-inner">
<h3 class="callout-title">Change the Rsync Port</h3>
<div class="callout-content">
<p>Say we have to connect <code>rsync</code> through port 768 instead of
22. How would we modify this command?</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} rsync amdahl.tar.gz {{ site.remote.user }}@{{ site.remote.login }}:</span></code></pre>
</div>
<p><em>Hint:</em> check the <code>man</code> page or “help” for
<code>rsync</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} man rsync</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} rsync <span class="at">--help</span> <span class="kw">|</span> <span class="fu">grep</span> port</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>     <span class="ex">--port=PORT</span>             specify double-colon alternate port number</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="ex">See</span> http://rsync.samba.org/ for updates, bug reports, and answers</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} rsync <span class="at">--port</span><span class="op">=</span>768 amdahl.tar.gz {{ site.remote.user }}@{{ site.remote.login }}:</span></code></pre>
</div>
<p>(Note that this command will fail, as the correct port in this case
is the default: 22.)</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="transferring-files-interactively-with-filezilla">Transferring Files Interactively with FileZilla<a class="anchor" aria-label="anchor" href="#transferring-files-interactively-with-filezilla"></a>
</h2>
<hr class="half-width">
<p>FileZilla is a cross-platform client for downloading and uploading
files to and from a remote computer. It is absolutely fool-proof and
always works quite well. It uses the <code>sftp</code> protocol. You can
read more about using the <code>sftp</code> protocol in the command line
in the <a href="discuss.html">lesson discussion</a>.</p>
<p>Download and install the FileZilla client from <a href="https://filezilla-project.org" class="external-link uri">https://filezilla-project.org</a>. After installing and
opening the program, you should end up with a window with a file browser
of your local system on the left hand side of the screen. When you
connect to the cluster, your cluster files will appear on the right hand
side.</p>
<p>To connect to the cluster, we’ll just need to enter our credentials
at the top of the screen:</p>
<ul>
<li>Host: <code>sftp://{{ site.remote.login }}</code>
</li>
<li>User: Your cluster username</li>
<li>Password: Your cluster password</li>
<li>Port: (leave blank to use the default port)</li>
</ul>
<p>Hit “Quickconnect” to connect. You should see your remote files
appear on the right hand side of the screen. You can drag-and-drop files
between the left (local) and right (remote) sides of the screen to
transfer files.</p>
<p>Finally, if you need to move large files (typically larger than a
gigabyte) from one remote computer to another remote computer, SSH in to
the computer hosting the files and use <code>scp</code> or
<code>rsync</code> to transfer over to the other. This will be more
efficient than using FileZilla (or related applications) that would copy
from the source to your local machine, then to the destination
machine.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>
<code>wget</code> and <code>curl -O</code> download a file from the
internet.</li>
<li>
<code>scp</code> and <code>rsync</code> transfer files to and from
your computer.</li>
<li>You can use an SFTP client like FileZilla to transfer files through
a GUI.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-17-parallel"><p>Content from <a href="17-parallel.html">Running a parallel job</a></p>
<hr>
<p>Last updated on 2024-09-26 |

        <a href="https://github.com/tobyhodges/probable-pancake/edit/main/episodes/17-parallel.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we execute a task in parallel?</li>
<li>What benefits arise from parallel execution?</li>
<li>What are the limits of gains from execution in parallel?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Install a Python package using <code>pip</code>
</li>
<li>Prepare a job submission script for the parallel executable.</li>
<li>Launch jobs with parallel execution.</li>
<li>Record and summarize the timing and accuracy of jobs.</li>
<li>Describe the relationship between job parallelism and
performance.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>We now have the tools we need to run a multi-processor job. This is a
very important aspect of HPC systems, as parallelism is one of the
primary tools we have to improve the performance of computational
tasks.</p>
<p>If you disconnected, log back in to the cluster.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} ssh {{ site.remote.user }}@{{ site.remote.login }}</span></code></pre>
</div>
<section><h2 class="section-heading" id="install-the-amdahl-program">Install the Amdahl Program<a class="anchor" aria-label="anchor" href="#install-the-amdahl-program"></a>
</h2>
<hr class="half-width">
<p>With the Amdahl source code on the cluster, we can install it, which
will provide access to the <code>amdahl</code> executable. Move into the
extracted directory, then use the Package Installer for Python, or
<code>pip</code>, to install it in your (“user”) home directory:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} cd amdahl</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} python3 <span class="at">-m</span> pip install <span class="at">--user</span> .</span></code></pre>
</div>
<div id="amdahl-is-python-code" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="amdahl-is-python-code" class="callout-inner">
<h3 class="callout-title">Amdahl is Python Code</h3>
<div class="callout-content">
<p>The Amdahl program is written in Python, and installing or using it
requires locating the <code>python3</code> executable on the login node.
If it can’t be found, try listing available modules using
<code>module avail</code>, load the appropriate one, and try the command
again.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="mpi-for-python">MPI for Python<a class="anchor" aria-label="anchor" href="#mpi-for-python"></a>
</h3>
<p>The Amdahl code has one dependency: <strong>mpi4py</strong>. If it
hasn’t already been installed on the cluster, <code>pip</code> will
attempt to collect mpi4py from the Internet and install it for you. If
this fails due to a one-way firewall, you must retrieve mpi4py on your
local machine and upload it, just as we did for Amdahl.</p>
<div id="retrieve-and-upload-mpi4py" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="retrieve-and-upload-mpi4py" class="callout-inner">
<h3 class="callout-title">Retrieve and Upload <code>mpi4py</code>
</h3>
<div class="callout-content">
<p>If installing Amdahl failed because mpi4py could not be installed,
retrieve the tarball from <a href="https://github.com/mpi4py/mpi4py/tarball/master" class="external-link uri">https://github.com/mpi4py/mpi4py/tarball/master</a> then
<code>rsync</code> it to the cluster, extract, and install:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} wget <span class="at">-O</span> mpi4py.tar.gz https://github.com/mpi4py/mpi4py/releases/download/3.1.4/mpi4py-3.1.4.tar.gz</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} scp mpi4py.tar.gz {{ site.remote.user }}@{{ site.remote.login }}:</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} rsync <span class="at">-avP</span> mpi4py.tar.gz {{ site.remote.user }}@{{ site.remote.login }}:</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} ssh {{ site.remote.user }}@{{ site.remote.login }}</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} tar <span class="at">-xvzf</span> mpi4py.tar.gz  <span class="co"># extract the archive</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} mv mpi4py<span class="pp">*</span> mpi4py        <span class="co"># rename the directory</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} cd mpi4py</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} python3 <span class="at">-m</span> pip install <span class="at">--user</span> .</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} cd ../amdahl</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} python3 <span class="at">-m</span> pip install <span class="at">--user</span> .</span></code></pre>
</div>
</div>
</div>
</div>
<div id="if-pip-raises-a-warning" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="if-pip-raises-a-warning" class="callout-inner">
<h3 class="callout-title">If <code>pip</code> Raises a Warning…</h3>
<div class="callout-content">
<p><code>pip</code> may warn that your user package binaries are not in
your PATH.</p>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>WARNING: The script amdahl is installed in "${HOME}/.local/bin" which is
not on PATH. Consider adding this directory to PATH or, if you prefer to
suppress this warning, use --no-warn-script-location.</code></pre>
</div>
<p>To check whether this warning is a problem, use <code>which</code> to
search for the <code>amdahl</code> program:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} which amdahl</span></code></pre>
</div>
<p>If the command returns no output, displaying a new prompt, it means
the file <code>amdahl</code> has not been found. You must update the
environment variable named <code>PATH</code> to include the missing
folder. Edit your shell configuration file as follows, then log off the
cluster and back on again so it takes effect.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} nano ~/.bashrc</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} tail ~/.bashrc</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>export PATH=${PATH}:${HOME}/.local/bin</code></pre>
</div>
<p>After logging back in to {{ site.remote.login }}, <code>which</code>
should be able to find <code>amdahl</code> without difficulties. If you
had to load a Python module, load it again.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="help">Help!<a class="anchor" aria-label="anchor" href="#help"></a>
</h2>
<hr class="half-width">
<p>Many command-line programs include a “help” message. Try it with
<code>amdahl</code>:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} amdahl <span class="at">--help</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>usage: amdahl [-h] [-p [PARALLEL_PROPORTION]] [-w [WORK_SECONDS]] [-t] [-e] [-j [JITTER_PROPORTION]]

optional arguments:
  -h, --help            show this help message and exit
  -p [PARALLEL_PROPORTION], --parallel-proportion [PARALLEL_PROPORTION]
                        Parallel proportion: a float between 0 and 1
  -w [WORK_SECONDS], --work-seconds [WORK_SECONDS]
                        Total seconds of workload: an integer greater than 0
  -t, --terse           Format output as a machine-readable object for easier analysis
  -e, --exact           Exactly match requested timing by disabling random jitter
  -j [JITTER_PROPORTION], --jitter-proportion [JITTER_PROPORTION]
                        Random jitter: a float between -1 and +1</code></pre>
</div>
<p>This message doesn’t tell us much about what the program
<em>does</em>, but it does tell us the important flags we might want to
use when launching it.</p>
</section><section><h2 class="section-heading" id="running-the-job-on-a-compute-node">Running the Job on a Compute Node<a class="anchor" aria-label="anchor" href="#running-the-job-on-a-compute-node"></a>
</h2>
<hr class="half-width">
<p>Create a submission file, requesting one task on a single node, then
launch it.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} nano serial-job.sh</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} cat serial-job.sh</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.bash_shebang }}</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="ex">{{</span> site.sched.comment }} {{ site.sched.flag.name }} solo-job</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="ex">{{</span> site.sched.comment }} {{ site.sched.flag.queue }} {{ site.sched.queue.testing }}</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="ex">{{</span> site.sched.comment }} <span class="at">-N</span> 1</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="ex">{{</span> site.sched.comment }} <span class="at">-n</span> 1</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co"># Load the computing environment we need</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="ex">module</span> load {{ site.remote.module_python3 }}</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co"># Execute the task</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="ex">amdahl</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.submit.name }} serial-job.sh</span></code></pre>
</div>
<p>As before, use the {{ site.sched.name }} status commands to check
whether your job is running and when it ends:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.status }} {{ site.sched.flag.user }}</span></code></pre>
</div>
<p>Use <code>ls</code> to locate the output file. The <code>-t</code>
flag sorts in reverse-chronological order: newest first. What was the
output?</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Read the Job Output </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" aria-labelledby="headingSpoiler1" data-bs-parent="#accordionSpoiler1">
<div class="accordion-body">
<p>The cluster output should be written to a file in the folder you
launched the job from. For example,</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} ls <span class="at">-t</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>slurm-347087.out  serial-job.sh  amdahl  README.md  LICENSE.txt</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} cat slurm-347087.out</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Doing 30.000 seconds of 'work' on 1 processor,
which should take 30.000 seconds with 0.850 parallel proportion of the workload.

  Hello, World! I am process 0 of 1 on {{ site.remote.node }}. I will do all the serial 'work' for 4.500 seconds.
  Hello, World! I am process 0 of 1 on {{ site.remote.node }}. I will do parallel 'work' for 25.500 seconds.

Total execution time (according to rank 0): 30.033 seconds</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>As we saw before, two of the <code>amdahl</code> program flags set
the amount of work and the proportion of that work that is parallel in
nature. Based on the output, we can see that the code uses a default of
30 seconds of work that is 85% parallel. The program ran for just over
30 seconds in total, and if we run the numbers, it is true that 15% of
it was marked ‘serial’ and 85% was ‘parallel’.</p>
<p>Since we only gave the job one CPU, this job wasn’t really parallel:
the same processor performed the ‘serial’ work for 4.5 seconds, then the
‘parallel’ part for 25.5 seconds, and no time was saved. The cluster can
do better, if we ask.</p>
</section><section><h2 class="section-heading" id="running-the-parallel-job">Running the Parallel Job<a class="anchor" aria-label="anchor" href="#running-the-parallel-job"></a>
</h2>
<hr class="half-width">
<p>The <code>amdahl</code> program uses the Message Passing Interface
(MPI) for parallelism -- this is a common tool on HPC systems.</p>
<div id="what-is-mpi" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="what-is-mpi" class="callout-inner">
<h3 class="callout-title">What is MPI?</h3>
<div class="callout-content">
<p>The Message Passing Interface is a set of tools which allow multiple
tasks running simultaneously to communicate with each other. Typically,
a single executable is run multiple times, possibly on different
machines, and the MPI tools are used to inform each instance of the
executable about its sibling processes, and which instance it is. MPI
also provides tools to allow communication between instances to
coordinate work, exchange information about elements of the task, or to
transfer data. An MPI instance typically has its own copy of all the
local variables.</p>
</div>
</div>
</div>
<p>While MPI-aware executables can generally be run as stand-alone
programs, in order for them to run in parallel they must use an MPI
<em>run-time environment</em>, which is a specific implementation of the
MPI <em>standard</em>. To activate the MPI environment, the program
should be started via a command such as <code>mpiexec</code> (or
<code>mpirun</code>, or <code>srun</code>, etc. depending on the MPI
run-time you need to use), which will ensure that the appropriate
run-time support for parallelism is included.</p>
<div id="mpi-runtime-arguments" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="mpi-runtime-arguments" class="callout-inner">
<h3 class="callout-title">MPI Runtime Arguments</h3>
<div class="callout-content">
<p>On their own, commands such as <code>mpiexec</code> can take many
arguments specifying how many machines will participate in the
execution, and you might need these if you would like to run an MPI
program on your own (for example, on your laptop). In the context of a
queuing system, however, it is frequently the case that MPI run-time
will obtain the necessary parameters from the queuing system, by
examining the environment variables set when the job is launched.</p>
</div>
</div>
</div>
<p>Let’s modify the job script to request more cores and use the MPI
run-time.</p>
<p><code>bash, bash {{ site.remote.prompt }} cp serial-job.sh parallel-job.sh {{ site.remote.prompt }} nano parallel-job.sh {{ site.remote.prompt }} cat parallel-job.sh</code></p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.bash_shebang }}</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="ex">{{</span> site.sched.comment }} {{ site.sched.flag.name }} parallel-job</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="ex">{{</span> site.sched.comment }} {{ site.sched.flag.queue }} {{ site.sched.queue.testing }}</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="ex">{{</span> site.sched.comment }} <span class="at">-N</span> 1</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="ex">{{</span> site.sched.comment }} <span class="at">-n</span> 4</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co"># Load the computing environment we need</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co"># (mpi4py and numpy are in SciPy-bundle)</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="ex">module</span> load {{ site.remote.module_python3 }}</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="ex">module</span> load SciPy-bundle</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="co"># Execute the task</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="ex">mpiexec</span> amdahl</span></code></pre>
</div>
<p>Then submit your job. Note that the submission command has not really
changed from how we submitted the serial job: all the parallel settings
are in the batch file rather than the command line.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.submit.name }} parallel-job.sh</span></code></pre>
</div>
<p>As before, use the status commands to check when your job runs.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} ls <span class="at">-t</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>slurm-347178.out  parallel-job.sh  slurm-347087.out  serial-job.sh  amdahl  README.md  LICENSE.txt</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} cat slurm-347178.out</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Doing 30.000 seconds of 'work' on 4 processors,
which should take 10.875 seconds with 0.850 parallel proportion of the workload.

  Hello, World! I am process 0 of 4 on {{ site.remote.node }}. I will do all the serial 'work' for 4.500 seconds.
  Hello, World! I am process 2 of 4 on {{ site.remote.node }}. I will do parallel 'work' for 6.375 seconds.
  Hello, World! I am process 1 of 4 on {{ site.remote.node }}. I will do parallel 'work' for 6.375 seconds.
  Hello, World! I am process 3 of 4 on {{ site.remote.node }}. I will do parallel 'work' for 6.375 seconds.
  Hello, World! I am process 0 of 4 on {{ site.remote.node }}. I will do parallel 'work' for 6.375 seconds.

Total execution time (according to rank 0): 10.888 seconds</code></pre>
</div>
<div id="is-it-4-faster" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="is-it-4-faster" class="callout-inner">
<h3 class="callout-title">Is it 4× faster?</h3>
<div class="callout-content">
<p>The parallel job received 4× more processors than the serial job:
does that mean it finished in ¼ the time?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>The parallel job did take <em>less</em> time: 11 seconds is better
than 30! But it is only a 2.7× improvement, not 4×.</p>
<p>Look at the job output:</p>
<ul>
<li>While “process 0” did serial work, processes 1 through 3 did their
parallel work.</li>
<li>While process 0 caught up on its parallel work, the rest did nothing
at all.</li>
</ul>
<p>Process 0 always has to finish its serial task before it can start on
the parallel work. This sets a lower limit on the amount of time this
job will take, no matter how many cores you throw at it.</p>
<p>This is the basic principle behind <a href="https://en.wikipedia.org/wiki/Amdahl's_law" class="external-link">Amdahl’s Law</a>,
which is one way of predicting improvements in execution time for a
<strong>fixed</strong> workload that can be subdivided and run in
parallel to some extent.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="how-much-does-parallel-execution-improve-performance">How Much Does Parallel Execution Improve Performance?<a class="anchor" aria-label="anchor" href="#how-much-does-parallel-execution-improve-performance"></a>
</h2>
<hr class="half-width">
<p>In theory, dividing up a perfectly parallel calculation among
<em>n</em> MPI processes should produce a decrease in total run time by
a factor of <em>n</em>. As we have just seen, real programs need some
time for the MPI processes to communicate and coordinate, and some types
of calculations can’t be subdivided: they only run effectively on a
single CPU.</p>
<p>Additionally, if the MPI processes operate on different physical CPUs
in the computer, or across multiple compute nodes, even more time is
required for communication than it takes when all processes operate on a
single CPU.</p>
<p>In practice, it’s common to evaluate the parallelism of an MPI
program by</p>
<ul>
<li>running the program across a range of CPU counts,</li>
<li>recording the execution time on each run,</li>
<li>comparing each execution time to the time when using a single
CPU.</li>
</ul>
<p>Since “more is better” – improvement is easier to interpret from
increases in some quantity than decreases – comparisons are made using
the speedup factor <em>S</em>, which is calculated as the single-CPU
execution time divided by the multi-CPU execution time. For a perfectly
parallel program, a plot of the speedup <em>S</em> versus the number of
CPUs <em>n</em> would give a straight line, <em>S</em> = <em>n</em>.</p>
<p>Let’s run one more job, so we can see how close to a straight line
our <code>amdahl</code> code gets.</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} nano parallel-job.sh</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} cat parallel-job.sh</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.bash_shebang }}</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="ex">{{</span> site.sched.comment }} {{ site.sched.flag.name }} parallel-job</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="ex">{{</span> site.sched.comment }} {{ site.sched.flag.queue }} {{ site.sched.queue.testing }}</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="ex">{{</span> site.sched.comment }} <span class="at">-N</span> 1</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="ex">{{</span> site.sched.comment }} <span class="at">-n</span> 8</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a><span class="co"># Load the computing environment we need</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a><span class="co"># (mpi4py and numpy are in SciPy-bundle)</span></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a><span class="ex">module</span> load {{ site.remote.module_python3 }}</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a><span class="ex">module</span> load SciPy-bundle</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a><span class="co"># Execute the task</span></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a><span class="ex">mpiexec</span> amdahl</span></code></pre>
</div>
<p>Then submit your job. Note that the submission command has not really
changed from how we submitted the serial job: all the parallel settings
are in the batch file rather than the command line.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.submit.name }} parallel-job.sh</span></code></pre>
</div>
<p>As before, use the status commands to check when your job runs.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} ls <span class="at">-t</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>slurm-347271.out  parallel-job.sh  slurm-347178.out  slurm-347087.out  serial-job.sh  amdahl  README.md  LICENSE.txt</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} cat slurm-347178.out</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>which should take 7.688 seconds with 0.850 parallel proportion of the workload.

  Hello, World! I am process 4 of 8 on {{ site.remote.node }}. I will do parallel 'work' for 3.188 seconds.
  Hello, World! I am process 0 of 8 on {{ site.remote.node }}. I will do all the serial 'work' for 4.500 seconds.
  Hello, World! I am process 2 of 8 on {{ site.remote.node }}. I will do parallel 'work' for 3.188 seconds.
  Hello, World! I am process 1 of 8 on {{ site.remote.node }}. I will do parallel 'work' for 3.188 seconds.
  Hello, World! I am process 3 of 8 on {{ site.remote.node }}. I will do parallel 'work' for 3.188 seconds.
  Hello, World! I am process 5 of 8 on {{ site.remote.node }}. I will do parallel 'work' for 3.188 seconds.
  Hello, World! I am process 6 of 8 on {{ site.remote.node }}. I will do parallel 'work' for 3.188 seconds.
  Hello, World! I am process 7 of 8 on {{ site.remote.node }}. I will do parallel 'work' for 3.188 seconds.
  Hello, World! I am process 0 of 8 on {{ site.remote.node }}. I will do parallel 'work' for 3.188 seconds.

Total execution time (according to rank 0): 7.697 seconds</code></pre>
</div>
<div id="non-linear-output" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="non-linear-output" class="callout-inner">
<h3 class="callout-title">Non-Linear Output</h3>
<div class="callout-content">
<p>When we ran the job with 4 parallel workers, the serial job wrote its
output first, then the parallel processes wrote their output, with
process 0 coming in first and last.</p>
<p>With 8 workers, this is not the case: since the parallel workers take
less time than the serial work, it is hard to say which process will
write its output first, except that it will <em>not</em> be process
0!</p>
</div>
</div>
</div>
<p>Now, let’s summarize the amount of time it took each job to run:</p>
<table class="table">
<thead><tr class="header">
<th>Number of CPUs</th>
<th>Runtime (sec)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>30.033</td>
</tr>
<tr class="even">
<td>4</td>
<td>10.888</td>
</tr>
<tr class="odd">
<td>8</td>
<td>7.697</td>
</tr>
</tbody>
</table>
<p>Then, use the first row to compute speedups <em>S</em>, using Python
as a command-line calculator:</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} for n in 30.033 10.888 7.697<span class="kw">;</span> <span class="cf">do</span> <span class="ex">python3</span> <span class="at">-c</span> <span class="st">"print(30.033 / </span><span class="va">$n</span><span class="st">)"</span><span class="kw">;</span> <span class="cf">done</span></span></code></pre>
</div>
<table class="table">
<thead><tr class="header">
<th>Number of CPUs</th>
<th>Speedup</th>
<th>Ideal</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1.0</td>
<td>1</td>
</tr>
<tr class="even">
<td>4</td>
<td>2.75</td>
<td>4</td>
</tr>
<tr class="odd">
<td>8</td>
<td>3.90</td>
<td>8</td>
</tr>
</tbody>
</table>
<p>The job output files have been telling us that this program is
performing 85% of its work in parallel, leaving 15% to run in serial.
This seems reasonably high, but our quick study of speedup shows that in
order to get a 4× speedup, we have to use 8 or 9 processors in parallel.
In real programs, the speedup factor is influenced by</p>
<ul>
<li>CPU design</li>
<li>communication network between compute nodes</li>
<li>MPI library implementations</li>
<li>details of the MPI program itself</li>
</ul>
<p>Using Amdahl’s Law, you can prove that with this program, it is
<em>impossible</em> to reach 8× speedup, no matter how many processors
you have on hand. Details of that analysis, with results to back it up,
are left for the next class in the HPC Carpentry workshop, <em>HPC
Workflows</em>.</p>
<p>In an HPC environment, we try to reduce the execution time for all
types of jobs, and MPI is an extremely common way to combine dozens,
hundreds, or thousands of CPUs into solving a single problem. To learn
more about parallelization, see the <a href="https://www.hpc-carpentry.org/hpc-parallel-novice/" class="external-link">parallel
novice lesson</a> lesson.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Parallel programming allows applications to take advantage of
parallel hardware.</li>
<li>The queuing system facilitates executing parallel tasks.</li>
<li>Performance improvements from parallel execution do not scale
linearly.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-18-resources"><p>Content from <a href="18-resources.html">Using resources effectively</a></p>
<hr>
<p>Last updated on 2024-09-26 |

        <a href="https://github.com/tobyhodges/probable-pancake/edit/main/episodes/18-resources.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I review past jobs?</li>
<li>How can I use this knowledge to create a more accurate submission
script?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Look up job statistics.</li>
<li>Make more accurate resource requests in job scripts based on data
describing past performance.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>We’ve touched on all the skills you need to interact with an HPC
cluster: logging in over SSH, loading software modules, submitting
parallel jobs, and finding the output. Let’s learn about estimating
resource usage and why it might matter.</p>
<section><h2 class="section-heading" id="estimating-required-resources-using-the-scheduler">Estimating Required Resources Using the Scheduler<a class="anchor" aria-label="anchor" href="#estimating-required-resources-using-the-scheduler"></a>
</h2>
<hr class="half-width">
<p>Although we covered requesting resources from the scheduler earlier
with the π code, how do we know what type of resources the software will
need in the first place, and its demand for each? In general, unless the
software documentation or user testimonials provide some idea, we won’t
know how much memory or compute time a program will need.</p>
<div id="read-the-documentation" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="read-the-documentation" class="callout-inner">
<h3 class="callout-title">Read the Documentation</h3>
<div class="callout-content">
<p>Most HPC facilities maintain documentation as a wiki, a website, or a
document sent along when you register for an account. Take a look at
these resources, and search for the software you plan to use: somebody
might have written up guidance for getting the most out of it.</p>
</div>
</div>
</div>
<p>A convenient way of figuring out the resources required for a job to
run successfully is to submit a test job, and then ask the scheduler
about its impact using <code>{{ site.sched.hist }}</code>. You can use
this knowledge to set up the next job with a closer estimate of its load
on the system. A good general rule is to ask the scheduler for 20% to
30% more time and memory than you expect the job to need. This ensures
that minor fluctuations in run time or memory use will not result in
your job being cancelled by the scheduler. Keep in mind that if you ask
for too much, your job may not run even though enough resources are
available, because the scheduler will be waiting for other people’s jobs
to finish and free up the resources needed to match what you asked
for.</p>
</section><section><h2 class="section-heading" id="stats">Stats<a class="anchor" aria-label="anchor" href="#stats"></a>
</h2>
<hr class="half-width">
<p>Since we already submitted <code>amdahl</code> to run on the cluster,
we can query the scheduler to see how long our job took and what
resources were used. We will use <code>{{ site.sched.hist }}</code> to
get statistics about <code>parallel-job.sh</code>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.hist }}</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>       JobID    JobName  Partition    Account  AllocCPUS      State ExitCode
------------ ---------- ---------- ---------- ---------- ---------- --------
7               file.sh cpubase_b+ def-spons+          1  COMPLETED      0:0
7.batch           batch            def-spons+          1  COMPLETED      0:0
7.extern         extern            def-spons+          1  COMPLETED      0:0
8               file.sh cpubase_b+ def-spons+          1  COMPLETED      0:0
8.batch           batch            def-spons+          1  COMPLETED      0:0
8.extern         extern            def-spons+          1  COMPLETED      0:0
9            example-j+ cpubase_b+ def-spons+          1  COMPLETED      0:0
9.batch           batch            def-spons+          1  COMPLETED      0:0
9.extern         extern            def-spons+          1  COMPLETED      0:0</code></pre>
</div>
<p>This shows all the jobs we ran today (note that there are multiple
entries per job). To get info about a specific job (for example,
347087), we change command slightly.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.hist }} {{ site.sched.flag.histdetail }} 347087</span></code></pre>
</div>
<p>It will show a lot of info; in fact, every single piece of info
collected on your job by the scheduler will show up here. It may be
useful to redirect this information to <code>less</code> to make it
easier to view (use the left and right arrow keys to scroll through
fields).</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">{{</span> site.remote.prompt }} {{ site.sched.hist }} {{ site.sched.flag.histdetail }} 347087 <span class="kw">|</span> <span class="fu">less</span> <span class="at">-S</span></span></code></pre>
</div>
<div id="discussion" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="discussion" class="callout-inner">
<h3 class="callout-title">Discussion</h3>
<div class="callout-content">
<p>This view can help compare the amount of time requested and actually
used, duration of residence in the queue before launching, and memory
footprint on the compute node(s).</p>
<p>How accurate were our estimates?</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="improving-resource-requests">Improving Resource Requests<a class="anchor" aria-label="anchor" href="#improving-resource-requests"></a>
</h2>
<hr class="half-width">
<p>From the job history, we see that <code>amdahl</code> jobs finished
executing in at most a few minutes, once dispatched. The time estimate
we provided in the job script was far too long! This makes it harder for
the queuing system to accurately estimate when resources will become
free for other jobs. Practically, this means that the queuing system
waits to dispatch our <code>amdahl</code> job until the full requested
time slot opens, instead of “sneaking it in” a much shorter window where
the job could actually finish. Specifying the expected runtime in the
submission script more accurately will help alleviate cluster congestion
and may get your job dispatched earlier.</p>
<div id="narrow-the-time-estimate" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="narrow-the-time-estimate" class="callout-inner">
<h3 class="callout-title">Narrow the Time Estimate</h3>
<div class="callout-content">
<p>Edit <code>parallel_job.sh</code> to set a better time estimate. How
close can you get?</p>
<p>Hint: use <code>{{ site.sched.flag.time }}</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>The following line tells {{ site.sched.name }} that our job should
finish within 2 minutes:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">{{</span> site.sched.comment }} {{ site.sched.flag.time }}{% if site.sched.name == <span class="st">"Slurm"</span> %} {% else %}={% endif %}00:02:00</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Accurate job scripts help the queuing system efficiently allocate
shared resources.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-19-responsibility"><p>Content from <a href="19-responsibility.html">Using shared resources responsibly</a></p>
<hr>
<p>Last updated on 2024-09-26 |

        <a href="https://github.com/tobyhodges/probable-pancake/edit/main/episodes/19-responsibility.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I be a responsible user?</li>
<li>How can I protect my data?</li>
<li>How can I best get large amounts of data off an HPC system?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe how the actions of a single user can affect the experience
of others on a shared system.</li>
<li>Discuss the behaviour of a considerate shared system citizen.</li>
<li>Explain the importance of backing up critical data.</li>
<li>Describe the challenges with transferring large amounts of data off
HPC systems.</li>
<li>Convert many files to a single archive file using tar.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>One of the major differences between using remote HPC resources and
your own system (e.g. your laptop) is that remote resources are shared.
How many users the resource is shared between at any one time varies
from system to system, but it is unlikely you will ever be the only user
logged into or using such a system.</p>
<p>The widespread usage of scheduling systems where users submit jobs on
HPC resources is a natural outcome of the shared nature of these
resources. There are other things you, as an upstanding member of the
community, need to consider.</p>
<section><h2 class="section-heading" id="be-kind-to-the-login-nodes">Be Kind to the Login Nodes<a class="anchor" aria-label="anchor" href="#be-kind-to-the-login-nodes"></a>
</h2>
<hr class="half-width">
<p>The login node is often busy managing all of the logged in users,
creating and editing files and compiling software. If the machine runs
out of memory or processing capacity, it will become very slow and
unusable for everyone. While the machine is meant to be used, be sure to
do so responsibly – in ways that will not adversely impact other users’
experience.</p>
<p>Login nodes are always the right place to launch jobs. Cluster
policies vary, but they may also be used for proving out workflows, and
in some cases, may host advanced cluster-specific debugging or
development tools. The cluster may have modules that need to be loaded,
possibly in a certain order, and paths or library versions that differ
from your laptop, and doing an interactive test run on the head node is
a quick and reliable way to discover and fix these issues.</p>
<div id="login-nodes-are-a-shared-resource" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="login-nodes-are-a-shared-resource" class="callout-inner">
<h3 class="callout-title">Login Nodes Are a Shared Resource</h3>
<div class="callout-content">
<p>Remember, the login node is shared with all other users and your
actions could cause issues for other people. Think carefully about the
potential implications of issuing commands that may use large amounts of
resource.</p>
<p>Unsure? Ask your friendly systems administrator (“sysadmin”) if the
thing you’re contemplating is suitable for the login node, or if there’s
another mechanism to get it done safely.</p>
</div>
</div>
</div>
<p>You can always use the commands <code>top</code> and
<code>ps ux</code> to list the processes that are running on the login
node along with the amount of CPU and memory they are using. If this
check reveals that the login node is somewhat idle, you can safely use
it for your non-routine processing task. If something goes wrong -- the
process takes too long, or doesn’t respond – you can use the
<code>kill</code> command along with the <em>PID</em> to terminate the
process.</p>
<div id="login-node-etiquette" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="login-node-etiquette" class="callout-inner">
<h3 class="callout-title">Login Node Etiquette</h3>
<div class="callout-content">
<p>Which of these commands would be a routine task to run on the login
node?</p>
<ol style="list-style-type: decimal">
<li><code>python physics_sim.py</code></li>
<li><code>make</code></li>
<li><code>create_directories.sh</code></li>
<li><code>molecular_dynamics_2</code></li>
<li><code>tar -xzf R-3.3.0.tar.gz</code></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Building software, creating directories, and unpacking software are
common and acceptable &gt; tasks for the login node: options #2
(<code>make</code>), #3 (<code>mkdir</code>), and #5 (<code>tar</code>)
are probably OK. Note that script names do not always reflect their
contents: before launching #3, please
<code>less create_directories.sh</code> and make sure it’s not a Trojan
horse.</p>
<p>Running resource-intensive applications is frowned upon. Unless you
are sure it will not affect other users, do not run jobs like #1
(<code>python</code>) or #4 (custom MD code). If you’re unsure, ask your
friendly sysadmin for advice.</p>
</div>
</div>
</div>
</div>
<p>If you experience performance issues with a login node you should
report it to the system staff (usually via the helpdesk) for them to
investigate.</p>
</section><section><h2 class="section-heading" id="test-before-scaling">Test Before Scaling<a class="anchor" aria-label="anchor" href="#test-before-scaling"></a>
</h2>
<hr class="half-width">
<p>Remember that you are generally charged for usage on shared systems.
A simple mistake in a job script can end up costing a large amount of
resource budget. Imagine a job script with a mistake that makes it sit
doing nothing for 24 hours on 1000 cores or one where you have requested
2000 cores by mistake and only use 100 of them! This problem can be
compounded when people write scripts that automate job submission (for
example, when running the same calculation or analysis over lots of
different parameters or files). When this happens it hurts both you (as
you waste lots of charged resource) and other users (who are blocked
from accessing the idle compute nodes). On very busy resources you may
wait many days in a queue for your job to fail within 10 seconds of
starting due to a trivial typo in the job script. This is extremely
frustrating!</p>
<p>Most systems provide dedicated resources for testing that have short
wait times to help you avoid this issue.</p>
<div id="test-job-submission-scripts-that-use-large-amounts-of-resources" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="test-job-submission-scripts-that-use-large-amounts-of-resources" class="callout-inner">
<h3 class="callout-title">Test Job Submission Scripts That Use Large Amounts of Resources</h3>
<div class="callout-content">
<p>Before submitting a large run of jobs, submit one as a test first to
make sure everything works as expected.</p>
<p>Before submitting a very large or very long job submit a short
truncated test to ensure that the job starts as expected.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="have-a-backup-plan">Have a Backup Plan<a class="anchor" aria-label="anchor" href="#have-a-backup-plan"></a>
</h2>
<hr class="half-width">
<p>Although many HPC systems keep backups, it does not always cover all
the file systems available and may only be for disaster recovery
purposes (i.e. for restoring the whole file system if lost rather than
an individual file or directory you have deleted by mistake). Protecting
critical data from corruption or deletion is primarily your
responsibility: keep your own backup copies.</p>
<p>Version control systems (such as Git) often have free, cloud-based
offerings (e.g., GitHub and GitLab) that are generally used for storing
source code. Even if you are not writing your own programs, these can be
very useful for storing job scripts, analysis scripts and small input
files.</p>
<p>If you are building software, you may have a large amount of source
code that you compile to build your executable. Since this data can
generally be recovered by re-downloading the code, or re-running the
checkout operation from the source code repository, this data is also
less critical to protect.</p>
<p>For larger amounts of data, especially important results from your
runs, which may be irreplaceable, you should make sure you have a robust
system in place for taking copies of data off the HPC system wherever
possible to backed-up storage. Tools such as <code>rsync</code> can be
very useful for this.</p>
<p>Your access to the shared HPC system will generally be time-limited
so you should ensure you have a plan for transferring your data off the
system before your access finishes. The time required to transfer large
amounts of data should not be underestimated and you should ensure you
have planned for this early enough (ideally, before you even start using
the system for your research).</p>
<p>In all these cases, the helpdesk of the system you are using should
be able to provide useful guidance on your options for data transfer for
the volumes of data you will be using.</p>
<div id="your-data-is-your-responsibility" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="your-data-is-your-responsibility" class="callout-inner">
<h3 class="callout-title">Your Data Is Your Responsibility</h3>
<div class="callout-content">
<p>Make sure you understand what the backup policy is on the file
systems on the system you are using and what implications this has for
your work if you lose your data on the system. Plan your backups of
critical data and how you will transfer data off the system throughout
the project.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="transferring-data">Transferring Data<a class="anchor" aria-label="anchor" href="#transferring-data"></a>
</h2>
<hr class="half-width">
<p>As mentioned above, many users run into the challenge of transferring
large amounts of data off HPC systems at some point (this is more often
in transferring data off than onto systems but the advice below applies
in either case). Data transfer speed may be limited by many different
factors so the best data transfer mechanism to use depends on the type
of data being transferred and where the data is going.</p>
<p>The components between your data’s source and destination have
varying levels of performance, and in particular, may have different
capabilities with respect to <strong>bandwidth</strong> and
<strong>latency</strong>.</p>
<p><strong>Bandwidth</strong> is generally the raw amount of data per
unit time a device is capable of transmitting or receiving. It’s a
common and generally well-understood metric.</p>
<p><strong>Latency</strong> is a bit more subtle. For data transfers, it
may be thought of as the amount of time it takes to get data out of
storage and into a transmittable form. Latency issues are the reason
it’s advisable to execute data transfers by moving a small number of
large files, rather than the converse.</p>
<p>Some of the key components and their associated issues are:</p>
<ul>
<li>
<strong>Disk speed</strong>: File systems on HPC systems are often
highly parallel, consisting of a very large number of high performance
disk drives. This allows them to support a very high data bandwidth.
Unless the remote system has a similar parallel file system you may find
your transfer speed limited by disk performance at that end.</li>
<li>
<strong>Meta-data performance</strong>: <em>Meta-data
operations</em> such as opening and closing files or listing the owner
or size of a file are much less parallel than read/write operations. If
your data consists of a very large number of small files you may find
your transfer speed is limited by meta-data operations. Meta-data
operations performed by other users of the system can also interact
strongly with those you perform so reducing the number of such
operations you use (by combining multiple files into a single file) may
reduce variability in your transfer rates and increase transfer
speeds.</li>
<li>
<strong>Network speed</strong>: Data transfer performance can be
limited by network speed. More importantly it is limited by the slowest
section of the network between source and destination. If you are
transferring to your laptop/workstation, this is likely to be its
connection (either via LAN or WiFi).</li>
<li>
<strong>Firewall speed</strong>: Most modern networks are protected
by some form of firewall that filters out malicious traffic. This
filtering has some overhead and can result in a reduction in data
transfer performance. The needs of a general purpose network that hosts
email/web-servers and desktop machines are quite different from a
research network that needs to support high volume data transfers. If
you are trying to transfer data to or from a host on a general purpose
network you may find the firewall for that network will limit the
transfer rate you can achieve.</li>
</ul>
<p>As mentioned above, if you have related data that consists of a large
number of small files it is strongly recommended to pack the files into
a larger <em>archive</em> file for long term storage and transfer. A
single large file makes more efficient use of the file system and is
easier to move, copy and transfer because significantly fewer metadata
operations are required. Archive files can be created using tools like
<code>tar</code> and <code>zip</code>. We have already met
<code>tar</code> when we talked about data transfer earlier.</p>
<figure><img src="/fig/responsibility-bandwidth.svg" max-width="90%" alt="Schematic of network bandwidth" class="figure mx-auto d-block"><div class="figcaption">Schematic diagram of bandwidth and latency for
disk and network I/O. Each of the components on the figure is connected
by a blue line of width proportional to the interface bandwidth. The
small mazes at the link points illustrate the latency of the link, with
more tortuous mazes indicating higher latency.</div>
</figure><div id="consider-the-best-way-to-transfer-data" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="consider-the-best-way-to-transfer-data" class="callout-inner">
<h3 class="callout-title">Consider the Best Way to Transfer Data</h3>
<div class="callout-content">
<p>If you are transferring large amounts of data you will need to think
about what may affect your transfer performance. It is always useful to
run some tests that you can use to extrapolate how long it will take to
transfer your data.</p>
<p>Say you have a “data” folder containing 10,000 or so files, a healthy
mix of small and large ASCII and binary data. Which of the following
would be the best way to transfer them to {{ site.remote.name }}?</p>
<ol style="list-style-type: decimal"><li>
</li></ol>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} scp <span class="at">-r</span> data {{ site.remote.user }}@{{ site.remote.login }}:~/</span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal"><li>
</li></ol>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} rsync <span class="at">-ra</span> data {{ site.remote.user }}@{{ site.remote.login }}:~/</span></code></pre>
</div>
<ol start="3" style="list-style-type: decimal"><li>
</li></ol>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} rsync <span class="at">-raz</span> data {{ site.remote.user }}@{{ site.remote.login }}:~/</span></code></pre>
</div>
<ol start="4" style="list-style-type: decimal"><li>
</li></ol>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} tar <span class="at">-cvf</span> data.tar data</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} rsync <span class="at">-raz</span> data.tar {{ site.remote.user }}@{{ site.remote.login }}:~/</span></code></pre>
</div>
<ol start="5" style="list-style-type: decimal"><li>
</li></ol>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} tar <span class="at">-cvzf</span> data.tar.gz data</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="ex">{{</span> site.local.prompt }} rsync <span class="at">-ra</span> data.tar.gz {{ site.remote.user }}@{{ site.remote.login }}:~/</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>
<code>scp</code> will recursively copy the directory. This works,
but without compression.</li>
<li>
<code>rsync -ra</code> works like <code>scp -r</code>, but preserves
file information like creation times. This is marginally better.</li>
<li>
<code>rsync -raz</code> adds compression, which will save some
bandwidth. If you have a strong CPU at both ends of the line, and you’re
on a slow network, this is a good choice.</li>
<li>This command first uses <code>tar</code> to merge everything into a
single file, then <code>rsync -z</code> to transfer it with compression.
With this large <em>number</em> of files, metadata overhead can hamper
your transfer, so this is a good idea.</li>
<li>This command uses <code>tar -z</code> to compress the archive, then
<code>rsync</code> to transfer it. This may perform similarly to #4, but
in most cases (for large datasets), it’s the best combination of high
throughput and low latency (making the most of your time and network
connection).</li>
</ol>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Be careful how you use the login node.</li>
<li>Your data on the system is your responsibility.</li>
<li>Plan and test large data transfers.</li>
<li>It is often best to convert many files to a single archive file
before transferring.</li>
</ul>
</div>
</div>
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/tobyhodges/probable-pancake/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/tobyhodges/probable-pancake/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/tobyhodges/probable-pancake/" class="external-link">Source</a></p>
				<p><a href="https://github.com/tobyhodges/probable-pancake/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.7" class="external-link">sandpaper (0.16.7)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.6" class="external-link">pegboard (0.7.6)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.4" class="external-link">varnish (1.0.4)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://tkphd.github.io/hpc-intro-online/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://tkphd.github.io/hpc-intro-online/aio.html",
  "identifier": "https://tkphd.github.io/hpc-intro-online/aio.html",
  "dateCreated": "2017-03-24",
  "dateModified": "2024-10-08",
  "datePublished": "2024-10-08"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo --><script>
          var _paq = window._paq = window._paq || [];
          /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
          _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
          _paq.push(["setDomains", ["*.lessons.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
          _paq.push(["setDoNotTrack", true]);
          _paq.push(["disableCookies"]);
          _paq.push(["trackPageView"]);
          _paq.push(["enableLinkTracking"]);
          (function() {
              var u="https://matomo.carpentries.org/";
              _paq.push(["setTrackerUrl", u+"matomo.php"]);
              _paq.push(["setSiteId", "1"]);
              var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0];
              g.async=true; g.src="https://matomo.carpentries.org/matomo.js"; s.parentNode.insertBefore(g,s);
          })();
        </script><!-- End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

